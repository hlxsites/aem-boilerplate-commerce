/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as r}from"@dropins/tools/preact-jsx-runtime.js";import{useState as b,useEffect as v,useRef as f}from"@dropins/tools/preact-compat.js";import{events as y}from"@dropins/tools/event-bus.js";import{p as M,s as h}from"../chunks/signals.js";import{useText as _}from"@dropins/tools/i18n.js";import"../chunks/state.js";import"@dropins/tools/signals.js";const g="en_US";function $(){const[a,t]=b(y.lastPayload("locale")||g);return v(()=>{const e=y.on("locale",t);return()=>e==null?void 0:e.off()},[a]),a}const s="payment-services_apple-pay-container",D=({getCartId:a,isVirtualCart:t,onButtonClick:e,onSuccess:c,onError:p,...d})=>{const{checkout:n}=M.value,l=f(null),o=f(null),m=$(),{methodNotAvailableMessage:L,methodNotLoadedMessage:P,methodLoadingMessage:S}=_({methodNotAvailableMessage:"PaymentServices.messages.methodNotAvailable",methodNotLoadedMessage:"PaymentServices.messages.methodNotLoaded",methodLoadingMessage:"PaymentServices.messages.methodLoading"});return v(()=>{if(!(n!=null&&n.Payment.ApplePay.isAvailable())||!o.current)return;const u=`apple-pay-${Math.random().toString(36).slice(2,11)}`;o.current.id=u;const N={getCartId:a,onSuccess:c,onError:p,buttonLanguage:{locale:A(m)},container:`#${u}`,isVirtualCart:async()=>t,onButtonClick:e};return n.Payment.ApplePay.render(N).then(i=>{l.current=i}).catch(i=>{console.error("Apple Pay render failed:",i)}),()=>{l.current&&l.current.teardown()}},[n,a,c,p,t,e,m]),n&&!n.Payment.ApplePay.isAvailable()?r("div",{ref:o,class:s,children:r("div",{class:"apple-pay-error",children:L})}):h.value==="error"?r("div",{ref:o,class:s,children:r("div",{class:"apple-pay-error",children:P})}):h.value==="initializing"?r("div",{ref:o,class:s,...d,children:r("div",{class:"apple-pay-loading",children:S})}):r("div",{ref:o,class:s,...d})};function A(a){const t=a.split("_");if(t.length<2){const e=A(g);return console.warn(`Cannot map elsie locale "${a}" to apple pay button locale. Falling back to "${e}".`),e}return`${t[0]}-${t[1]}`}export{D as ApplePay,D as default};
//# sourceMappingURL=ApplePay.js.map
