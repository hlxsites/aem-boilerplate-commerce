/*! Copyright 2026 Adobe
All Rights Reserved. */
import{jsx as h,jsxs as j,Fragment as q}from"@dropins/tools/preact-jsx-runtime.js";import{useRef as H,useState as B,useCallback as S,useEffect as k}from"@dropins/tools/preact-hooks.js";import{initReCaptcha as z}from"@dropins/tools/recaptcha.js";import{useText as v}from"@dropins/tools/i18n.js";import{classes as w,Slot as W}from"@dropins/tools/lib.js";import{memo as F}from"@dropins/tools/preact-compat.js";import{Field as K,Input as V,Picker as J,InputDate as Y,Checkbox as Q,TextArea as rr}from"@dropins/tools/components.js";var I=(r=>(r.REQUIRED_FIELD_ERROR="requiredFieldError",r.NUMERIC_ERROR="numericError",r.ALPHA_NUM_WITH_SPACES_ERROR="alphaNumWithSpacesError",r.ALPHA_NUMERIC_ERROR="alphaNumericError",r.ALPHA_ERROR="alphaError",r.EMAIL_ERROR="emailError",r.DATE_ERROR="dateError",r.DATE_RANGE_ERROR="dateRangeError",r.DATE_MAX_ERROR="dateMaxError",r.DATE_MIN_ERROR="dateMinError",r.URL_ERROR="urlError",r.LENGTH_TEXT_ERROR="lengthTextError",r))(I||{});const f="/",er=r=>{const e=v(r),t=Object.entries(e).filter(([o,d])=>d===null&&Object.values(I).includes(o)).map(([o])=>o),a=t.reduce((o,d)=>(o[d]=`Auth.FormText.${d}`,o),{}),n=v(a);return{...e,...t.reduce((o,d)=>(o[d]=n[d],o),{})}},tr=r=>r.reduce((e,t)=>({...e,[t.name]:t.value}),{}),ar=r=>/^\d+$/.test(r),nr=r=>/^[a-zA-Z0-9\s]+$/.test(r),or=r=>/^[a-zA-Z0-9]+$/.test(r),ur=r=>/^[a-zA-Z]+$/.test(r),lr=r=>/^[a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]+(\.[a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]+)*@([a-z0-9-]+\.)+[a-z]{2,}$/i.test(r),sr=r=>/^\d{4}-\d{2}-\d{2}$/.test(r)&&!isNaN(Date.parse(r)),cr=(r,e,t)=>{const a=new Date(r).getTime()/1e3;return!(isNaN(a)||a<0||typeof e<"u"&&a<e||typeof t<"u"&&a>t)},L=r=>{if(!r||r.trim()==="")return"";const e=parseInt(r,10);if(!isNaN(e)){const n=new Date(e*1e3);return isNaN(n.getTime())?"":n.toISOString().split("T")[0]}const t=new Date(r);if(isNaN(t.getTime()))return"";const a=parseInt(r.split("-")[1],10);return a>12||a<1?"":t.toISOString().split("T")[0]},dr=r=>/^(https?|ftp):\/\/(([A-Z0-9]([A-Z0-9_-]*[A-Z0-9]|))(\.[A-Z0-9]([A-Z0-9_-]*[A-Z0-9]|))*)(:(\d+))?(\/[A-Z0-9~](([A-Z0-9_~-]|\.)*[A-Z0-9~]|))*\/?(.*)?$/i.test(r),Er=(r,e,t)=>{const a=r.length;return a>=e&&a<=t},P=(r,e,t,a)=>{var g,G;const{requiredFieldError:n,lengthTextError:o,numericError:d,alphaNumWithSpacesError:s,alphaNumericError:T,alphaError:i,emailError:$,dateError:x,urlError:O,dateRangeError:D,dateMaxError:p,dateMinError:R}=t,l=e==null?void 0:e.customUpperCode,_={[l]:""};if(a[l]&&delete a[l],e!=null&&e.required&&(!r||r==="false"))return{[l]:`${I.REQUIRED_FIELD_ERROR}${f}${n}`};if(!(e!=null&&e.required)&&!r||!((g=e==null?void 0:e.validateRules)!=null&&g.length))return _;const M=tr(e==null?void 0:e.validateRules),E=M.MIN_TEXT_LENGTH??1,A=M.MAX_TEXT_LENGTH??255,u=M.DATE_RANGE_MIN,c=M.DATE_RANGE_MAX;if(!Er(r,+E,+A)&&!(u||c)){const m=o.replace("{min}",E).replace("{max}",A);return{[l]:`${I.LENGTH_TEXT_ERROR}${f}${m}`}}if(!cr(r,+u,+c)&&(u||c)){if(u&&u){const m=D.replace("{min}",L(u)).replace("{max}",L(c));return{[l]:`${I.DATE_RANGE_ERROR}${f}${m}`}}if(typeof u>"u"&&typeof c<"u"){const m=p.replace("{max}",L(c));return{[l]:`${I.DATE_MAX_ERROR}${f}${m}`}}if(typeof c>"u"&&typeof u<"u"){const m=R.replace("{min}",L(u));return{[l]:`${I.DATE_MIN_ERROR}${f}${m}`}}}const C={numeric:{validate:ar,error:`${I.NUMERIC_ERROR}${f}${d}`},"alphanum-with-spaces":{validate:nr,error:`${I.ALPHA_NUM_WITH_SPACES_ERROR}${f}${s}`},alphanumeric:{validate:or,error:`${I.ALPHA_NUMERIC_ERROR}${f}${T}`},alpha:{validate:ur,error:`${I.ALPHA_ERROR}${f}${i}`},email:{validate:lr,error:`${I.EMAIL_ERROR}${f}${$}`},date:{validate:sr,error:`${I.DATE_ERROR}${f}${x}`},url:{validate:dr,error:`${I.URL_ERROR}${f}${O}`}}[M.INPUT_VALIDATION];return C&&!C.validate(r)&&!((G=a[l])!=null&&G.length)?{[l]:C.error}:_},Rr=r=>r.reduce((e,{customUpperCode:t,required:a,defaultValue:n})=>(a&&t&&(e.initialData[t]=n||"",e.errorList[t]=""),e),{initialData:{},errorList:{}}),hr=["auth-reset-password-form__buttons--signin","auth-sign-up-form-buttons--signin","auth-sign-in-form__button--forgot","auth-sign-in-form__button--signup"],pr=({fieldsConfig:r,onSubmit:e})=>{const t=er({requiredFieldError:"Auth.FormText.requiredFieldError.default",lengthTextError:"Auth.FormText.lengthTextError.default",numericError:"Auth.FormText.numericError.default",alphaNumWithSpacesError:"Account.FormText.alphaNumWithSpacesError.default",alphaNumericError:"Auth.FormText.alphaNumericError.default",alphaError:"Auth.FormText.alphaError.default",emailError:"Auth.FormText.emailError.default",dateError:"Auth.FormText.dateError.default",dateRangeError:"Auth.FormText.dateRangeError.default",dateMaxError:"Auth.FormText.dateMaxError.default",dateMinError:"Auth.FormText.dateMinError.default",urlError:"Auth.FormText.urlError.default"}),a=H(null),n=H(!1),[o,d]=B({}),[s,T]=B({}),i=S(()=>{let p=!0;const R={...s};let l=null;for(const[_,M]of Object.entries(o)){const E=r==null?void 0:r.find(u=>{var c;return(c=u==null?void 0:u.customUpperCode)==null?void 0:c.includes(_)}),A=P(M.toString(),E,t,R);A[_]&&(Object.assign(R,A),p=!1),l||(l=Object.keys(R).find(u=>R[u])??null)}if(T(R),l&&a.current){const _=a.current.elements.namedItem(l);_==null||_.focus()}return p},[s,r,o,t]);k(()=>{if(r!=null&&r.length){const{initialData:p,errorList:R}=Rr(r);d(l=>({...p,...l})),T(R)}},[JSON.stringify(r)]);const $=S(async p=>{const R=p.target,l=!hr.some(_=>R.classList.contains(_));!n.current&&l&&(await z(0),n.current=!0)},[]),x=S(p=>{const{name:R,value:l,type:_,checked:M}=p==null?void 0:p.target,E=_==="checkbox"?M:l;d(c=>({...c,[R]:E}));const A=r==null?void 0:r.find(c=>{var N;return(N=c==null?void 0:c.customUpperCode)==null?void 0:N.includes(R)});let u={...s};if(A){const c=P(E.toString(),A,t,u);c&&Object.assign(u,c),T(u)}},[r,s,t]),O=S(p=>{const{name:R,value:l,type:_,checked:M}=p==null?void 0:p.target,E=_==="checkbox"?M:l,A=r==null?void 0:r.find(u=>u.customUpperCode===R);if(A){const u={...s},c=P(E.toString(),A,t,u);c&&Object.assign(u,c),T(u)}},[s,r,t]),D=S(p=>{p.preventDefault();const R=i();e==null||e(p,R)},[i,e]);return{formData:o,errors:s,formRef:a,handleChange:x,handleBlur:O,handleSubmit:D,handleFocus:$}};var b=(r=>(r.BOOLEAN="BOOLEAN",r.DATE="DATE",r.DATETIME="DATETIME",r.DROPDOWN="DROPDOWN",r.FILE="FILE",r.GALLERY="GALLERY",r.HIDDEN="HIDDEN",r.IMAGE="IMAGE",r.MEDIA_IMAGE="MEDIA_IMAGE",r.MULTILINE="MULTILINE",r.MULTISELECT="MULTISELECT",r.PRICE="PRICE",r.SELECT="SELECT",r.TEXT="TEXT",r.TEXTAREA="TEXTAREA",r.UNDEFINED="UNDEFINED",r.VISUAL="VISUAL",r.WEIGHT="WEIGHT",r.EMPTY="",r))(b||{});const Z=r=>{const e={errorKey:"",defaultErrorMessage:""};if(!r)return e;const t=r.indexOf(f);return t===-1?e:{errorKey:r.substring(0,t).trim(),defaultErrorMessage:r.substring(t+f.length).trim()}},U=F(({item:r,errorConfig:e,className:t,itemClassName:a,loading:n,children:o})=>{const{errorKey:d,defaultErrorMessage:s}=Z(e),T=v(`Auth.FormText.${d}.${r.code}`)[r.code];let i="";return s.length&&(i=T||s),h(K,{error:i,className:w([a,`${a}--${r.id}`,[`${a}--${r.id}-hidden`,r.isHidden],r.className]),"data-testid":`${t}--${r.id}`,disabled:n||r.disabled,children:o},r.id)}),X=F(({item:r,valueMessage:e,errorConfig:t,onBlur:a,onChange:n,onFocus:o,className:d,itemClassName:s,loading:T})=>h(U,{item:r,errorConfig:t,className:d,itemClassName:s,loading:T,children:h(V,{type:"text",name:r.customUpperCode,value:e??r.defaultValue,placeholder:r.label,floatingLabel:`${r.label} ${r.required?"*":""}`,autocomplete:r.autocomplete,onBlur:a,onChange:n,onFocus:o})})),y=F(({item:r,valueMessage:e,errorConfig:t,onBlur:a,onChange:n,className:o,itemClassName:d,loading:s})=>{var i;const T=(i=r.options.find($=>$.isDefault))==null?void 0:i.value;return h(U,{item:r,errorConfig:t,className:o,itemClassName:d,loading:s,children:h(J,{name:r.customUpperCode,floatingLabel:`${r.label} ${r.required?"*":""}`,placeholder:r.label,"aria-label":r.label,options:r.options,onBlur:a,handleSelect:n,defaultValue:T??e??r.defaultValue,value:T??e??r.defaultValue})})}),Ar=F(({item:r,valueMessage:e,errorConfig:t,onBlur:a,onChange:n,className:o,itemClassName:d,loading:s})=>h(U,{item:r,errorConfig:t,className:o,itemClassName:d,loading:s,children:h(Y,{type:"text",name:r.customUpperCode,value:e||r.defaultValue,placeholder:r.label,floatingLabel:`${r.label} ${r.required?"*":""}`,onBlur:a,onChange:n,disabled:s||r.disabled})})),Tr=F(({item:r,valueMessage:e,errorConfig:t,onBlur:a,onChange:n,className:o,itemClassName:d,loading:s})=>h(U,{item:r,errorConfig:t,className:o,itemClassName:d,loading:s,children:h(Q,{name:r.customUpperCode,checked:e||r.defaultValue,placeholder:r.label,label:`${r.label} ${r.required?"*":""}`,onBlur:a,onChange:n})})),_r=F(({item:r,valueMessage:e,errorConfig:t,onBlur:a,onChange:n,className:o,itemClassName:d,loading:s})=>h(U,{item:r,errorConfig:t,className:o,itemClassName:d,loading:s,children:h(rr,{name:r.customUpperCode,value:e??r.defaultValue,label:`${r.label} ${r.required?"*":""}`,onBlur:a,onChange:n})})),ir=({slots:r,item:e,handleOnChange:t,handleOnBlur:a,handleOnFocus:n,errorConfig:o,errors:d})=>{const{errorKey:s,defaultErrorMessage:T}=Z(o),i=v(`Auth.FormText.${s}.${e.code}`)[e.code];let $="";T.length&&($=i||T);const x={inputName:e.customUpperCode,handleOnChange:t,handleOnBlur:a,handleOnFocus:n,errorMessage:$,errors:d,config:e};return h(W,{"data-testid":`signUpFormInput_${e.code}`,name:`SignUpFormInput_${e.code}`,slot:r==null?void 0:r[`SignUpFormInput_${e.code}`],context:x},e.id)},xr=F(({slots:r,name:e,loading:t,children:a,className:n="defaultForm",fieldsConfig:o=[],onSubmit:d,formSlot:s,...T})=>{const{formData:i,errors:$,formRef:x,handleChange:O,handleBlur:D,handleSubmit:p,handleFocus:R}=pr({onSubmit:d,fieldsConfig:o}),l=`${n}__field`,_=j(q,{children:[o.map(E=>{const A=$==null?void 0:$[E.customUpperCode],u=i==null?void 0:i[E.customUpperCode],c=!!(r!=null&&r[`SignUpFormInput_${E.code}`]),N=h(ir,{slots:r,item:E,handleOnChange:O,handleOnBlur:D,handleOnFocus:R,errorConfig:A,errors:$});switch(E.fieldType){case b.TEXT:return c?N:E.options.length?h(y,{item:E,valueMessage:u,errorConfig:A,onBlur:D,onChange:O,onFocus:R,itemClassName:l,className:n,loading:t}):h(X,{item:E,valueMessage:u,errorConfig:A,onBlur:D,onChange:O,onFocus:R,itemClassName:l,className:n,loading:t});case b.MULTILINE:return c?N:h(X,{item:E,valueMessage:u,errorConfig:A,onBlur:D,onChange:O,onFocus:R,itemClassName:l,className:n,loading:t});case b.SELECT:return c?N:h(y,{item:E,valueMessage:u,errorConfig:A,onBlur:D,onChange:O,itemClassName:l,className:n,loading:t});case b.DATE:return c?N:h(Ar,{item:E,valueMessage:u,errorConfig:A,onBlur:D,onChange:O,itemClassName:l,className:n,loading:t});case b.BOOLEAN:return c?N:h(Tr,{item:E,valueMessage:u,errorConfig:A,onBlur:D,onChange:O,itemClassName:l,className:n,loading:t});case b.TEXTAREA:return c?N:h(_r,{item:E,valueMessage:u,errorConfig:A,onBlur:D,onChange:O,itemClassName:l,className:n,loading:t});default:return null}}),a]}),M={...s.context||{},__formContentKey:[o.map(E=>E.id||E.code).join(","),JSON.stringify($),JSON.stringify(i)].join("|")};return h("form",{onSubmit:p,name:e,ref:x,onFocus:R,...T,children:h(W,{name:s.name,slot:s.slot,context:M,className:n,"data-testid":s.dataTestId,children:_})})});export{xr as F,er as u,lr as v};
//# sourceMappingURL=Button.js.map
