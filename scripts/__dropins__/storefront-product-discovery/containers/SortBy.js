/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as g}from"@dropins/tools/preact-jsx-runtime.js";import{useState as a,useEffect as w}from"@dropins/tools/preact-compat.js";import{Picker as $}from"@dropins/tools/components.js";import{events as d}from"@dropins/tools/event-bus.js";import{d as x}from"../chunks/search.js";import{useText as p}from"@dropins/tools/i18n.js";import"@dropins/tools/lib.js";import"../fragments.js";import"../chunks/acdlEvents.js";import"@dropins/tools/fetch-graphql.js";const V=({scope:t,onSortChange:e})=>{const r=p({sortLabel:"Search.PLP.SortDropdown.title",lowToHigh:"Search.SortBy.lowToHigh",highToLow:"Search.SortBy.highToLow"}),[s,n]=a([]),[f,S]=a("relevance_DESC"),[b,h]=a({});w(()=>{const o=d.on("search/result",i=>{var u,c;if(h(i.request),(c=(u=i.result)==null?void 0:u.metadata)!=null&&c.sortableAttributes&&(n([...i.result.metadata.sortableAttributes]),i.request.sort)){const l=C(i.request.sort);l&&S(l)}},{eager:!0,scope:t});return()=>{o==null||o.off()}},[]);const m=async o=>{e==null||e(o[0]),x({...b,sort:o,currentPage:1},{scope:t})};return g($,{required:!0,floatingLabel:r.sortLabel,...L(s,r),value:f,handleSelect:o=>{const{value:i}=o.target,u=T(i);m(u)}})};function L(t,e){const r=[];return t.forEach((s,n)=>{s.bidirectional?r.splice(n+r.length,0,{text:`${s.label}: ${e.lowToHigh}`,value:`${s.attribute}_ASC`},{text:`${s.label}: ${e.highToLow}`,value:`${s.attribute}_DESC`}):r.splice(n+r.length,0,{text:s.label,value:`${s.attribute}_DESC`})}),{options:r}}function T(t){const e=t.indexOf("_");return[{attribute:t.substring(0,e),direction:t.substring(e+1)==="ASC"?"ASC":"DESC"}]}function C(t){return t.length>0&&t[0]?`${t[0].attribute}_${t[0].direction}`:""}export{V as SortBy,V as default};
//# sourceMappingURL=SortBy.js.map
