/*! Copyright 2026 Adobe
All Rights Reserved. */
import{jsx as l,jsxs as B}from"@dropins/tools/preact-jsx-runtime.js";import{useState as D,useEffect as G,useMemo as I}from"@dropins/tools/preact-compat.js";import{Slot as E}from"@dropins/tools/lib.js";import{Image as M}from"@dropins/tools/components.js";import{events as H}from"@dropins/tools/event-bus.js";import{g as Q}from"../chunks/getFetchedProductData.js";import{Z as s,C as O,O as W}from"../chunks/Zoom.js";/* empty css                  */import"@dropins/tools/preact-hooks.js";/* empty css                       *//* empty css                           */import{useText as X}from"@dropins/tools/i18n.js";import"@dropins/tools/preact.js";const Y=[".mp4",".webm",".ogg",".mov",".avi",".mkv"];function q(c){if(!c)return!1;const n=c.toLowerCase();return Y.some(y=>n.includes(y))}function Z(c,n){if(n)return n;if(c!=null&&c.includes("adobeaemcloud.com")&&c.endsWith("/play"))return c.replace(/\/play$/,"/as/thumbnail.png")}function J(c){if(!c)return"";const n=c.match(/(?:youtube\.com\/(?:watch\?v=|embed\/)|youtu\.be\/)([a-zA-Z0-9_-]+)/);if(n)return`https://www.youtube.com/embed/${n[1]}?rel=0`;const y=c.match(/vimeo\.com\/(?:video\/)?(\d+)/);return y?`https://player.vimeo.com/video/${y[1]}`:c}const K=({initialData:c=null,scope:n,controls:y="dots",loop:T=!0,peak:j=!1,gap:R=null,arrows:V=!0,arrowsOnMainImage:$=!1,zoom:g=!1,videos:v=!1,imageParams:t,thumbnailParams:o,children:L,slots:p,...k})=>{const h=X("PDP.Product.Image.label").label,[d,z]=D(c),[C,S]=D(null);G(()=>{const e=H.on("pdp/data",z,{scope:n});return()=>{e==null||e.off()}},[n]);const _=I(()=>({data:d}),[d]),r=I(()=>{var A,f;const e=((A=d==null?void 0:d.images)==null?void 0:A.map(u=>({type:"image",url:u.url,label:u.label})))??[];if(!v)return e;const i=((f=d==null?void 0:d.videos)==null?void 0:f.map(u=>({type:"video",url:u.url,label:u.title??"",preview:u.preview})))??[];return(typeof v=="object"?v.position:"last")==="first"?[...i,...e]:[...e,...i]},[d==null?void 0:d.images,d==null?void 0:d.videos,v]),x=I(()=>r.length>0?r.map((e,i)=>{const w=({...A})=>{var N;const f={title:e.label,src:e.url,alt:h==null?void 0:h.replace("{product}",e.label).replace("{key}",String(i+1)).replace("{total}",String(r.length)),width:(t==null?void 0:t.width)??960,height:(t==null?void 0:t.height)??1191,params:t??{width:960},loading:i===0?"eager":"lazy",...A},u=e.type==="video"?Z(e.url,(N=e.preview)==null?void 0:N.url):void 0;return l(E,{name:"CarouselMainImage",slot:p==null?void 0:p.CarouselMainImage,context:{..._,defaultImageProps:f,mediaType:e.type,previewUrl:u},children:e.type==="video"?q(e.url)?B("video",{className:"pdp-product-gallery__video",controls:!0,preload:"metadata",poster:u,width:(t==null?void 0:t.width)??960,height:(t==null?void 0:t.height)??1191,children:[l("source",{src:e.url,type:"video/mp4"}),"Your browser does not support the video tag."]}):l("iframe",{className:"pdp-product-gallery__video-iframe",src:J(e.url),width:(t==null?void 0:t.width)??960,height:(t==null?void 0:t.height)??1191,frameBorder:"0",loading:"lazy",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}):l(M,{...f})})};return g?l(s,{closeButton:typeof g=="object"?g.closeButton:!1,children:l(w,{})},e.url):l(w,{onClick:()=>S(i)},e.url)}):l("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",className:"pdp-product-gallery__images__placeholder",width:(t==null?void 0:t.width)??960,height:(t==null?void 0:t.height)??1191,"aria-hidden":!0},"pleaceholder"),[h,r,t,g,_,p==null?void 0:p.CarouselMainImage]),F=I(()=>r.length>0?r.map((e,i)=>{var f;const w={title:e.label,src:e.url,alt:h==null?void 0:h.replace("{product}",e.label).replace("{key}",String(i+1)).replace("{total}",String(r.length)),width:(o==null?void 0:o.width)??200,height:(o==null?void 0:o.height)??248,params:o??{width:200},loading:"lazy"},A=e.type==="video"?Z(e.url,(f=e.preview)==null?void 0:f.url):void 0;return l(E,{name:"CarouselThumbnail",slotTag:"span",contentTag:"span",slot:p==null?void 0:p.CarouselThumbnail,context:{..._,defaultImageProps:w,mediaType:e.type,previewUrl:A},children:e.type==="video"?B("span",{className:"pdp-product-gallery__video-thumbnail",children:[A?l("img",{src:A,alt:`Video: ${e.label}`,width:(o==null?void 0:o.width)??200,height:(o==null?void 0:o.height)??248,loading:"lazy"}):l("span",{className:"pdp-product-gallery__video-thumbnail-placeholder",style:{width:(o==null?void 0:o.width)??200,height:(o==null?void 0:o.height)??248}}),l("span",{className:"pdp-product-gallery__video-icon",children:"â–¶"})]}):l(M,{...w})},e.url)}):l("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",className:"pdp-product-gallery__thumbnail__placeholder",width:(o==null?void 0:o.width)??200,height:(o==null?void 0:o.height)??248,"aria-hidden":!0},"pleaceholder"),[h,r,o,_,p==null?void 0:p.CarouselThumbnail]);return d?B("div",{...k,children:[l(O,{arrows:!!r.length&&V,arrowsOnMainImage:$,controls:r.length?y:void 0,loop:T&&!!r.length,peak:!!r.length&&j,gap:R,defaultIndex:C||0,thumbnails:F,children:x}),C===null?null:l(W,{onClose:()=>S(null),centered:!0,children:l(O,{arrows:!!r.length,width:"100%",height:"100%",defaultIndex:C,loop:T&&!!r.length,controls:"dots",isZoomed:!0,children:x})})]}):null};K.getInitialData=Q;export{K as ProductGallery,K as default};
//# sourceMappingURL=ProductGallery.js.map
