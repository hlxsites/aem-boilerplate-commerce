/*! Copyright 2025 Adobe
All Rights Reserved. */
var b=Object.defineProperty;var F=(r,t,e)=>t in r?b(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var h=(r,t,e)=>F(r,typeof t!="symbol"?t+"":t,e);const u={"Content-Type":"application/json",Accept:"application/json"};class H{constructor(){h(this,"_endpoint");h(this,"_inheritHeaders");h(this,"_fetchGraphQlHeaders",{});h(this,"_beforeHooks",[]);h(this,"_afterHooks",[])}get endpoint(){return this._endpoint}get fetchGraphQlHeaders(){return this._fetchGraphQlHeaders}setEndpoint(t,e){this._endpoint=t,this._inheritHeaders=e==null?void 0:e.inheritHeaders}setFetchGraphQlHeader(t,e){this._fetchGraphQlHeaders={...this.fetchGraphQlHeaders,[t]:e}}removeFetchGraphQlHeader(t){delete this._fetchGraphQlHeaders[t]}getFetchGraphQlHeader(t){return this._fetchGraphQlHeaders[t]}setFetchGraphQlHeaders(t){typeof t=="function"?this._fetchGraphQlHeaders={...this._fetchGraphQlHeaders,...t(this._fetchGraphQlHeaders)}:this._fetchGraphQlHeaders={...t}}addBeforeHook(t){this._beforeHooks.push(t)}addAfterHook(t){this._afterHooks.push(t)}async fetchGraphQl(t,e){const l=this.endpoint,p=this.fetchGraphQlHeaders;if(!l)throw Error('Missing "url"');const s=(e==null?void 0:e.method)??"POST",G=e==null?void 0:e.cache,Q=e==null?void 0:e.signal;let f;const d=new URL(l),o={...u,...p};s==="POST"&&(f=JSON.stringify({query:t,variables:e==null?void 0:e.variables})),s==="GET"&&(d.searchParams.append("query",k(t)),e!=null&&e.variables&&d.searchParams.append("variables",JSON.stringify(e.variables)));let a={method:s,headers:o,body:f,cache:G,signal:Q};return a=await this._beforeHooks.reduce(async(i,c)=>c(await i),Promise.resolve(a)),await fetch(d,a).then(i=>i.json().then(c=>this._afterHooks.reduce(async(g,_)=>_(a,await g),Promise.resolve(c))))}getConfig(){return{endpoint:this.endpoint,fetchGraphQlHeaders:this.fetchGraphQlHeaders}}getMethods(){return{setEndpoint:this.setEndpoint.bind(this),setFetchGraphQlHeader:this.setFetchGraphQlHeader.bind(this),getFetchGraphQlHeader:this.getFetchGraphQlHeader.bind(this),removeFetchGraphQlHeader:this.removeFetchGraphQlHeader.bind(this),setFetchGraphQlHeaders:this.setFetchGraphQlHeaders.bind(this),fetchGraphQl:this.fetchGraphQl.bind(this),getConfig:this.getConfig.bind(this),addBeforeHook:this.addBeforeHook.bind(this),addAfterHook:this.addAfterHook.bind(this)}}}const n=new H;class v extends H{get endpoint(){return this._endpoint??n.endpoint}get fetchGraphQlHeaders(){return this._endpoint&&!this._inheritHeaders?this._fetchGraphQlHeaders:{...n.fetchGraphQlHeaders,...this._fetchGraphQlHeaders}}}function k(r){return r=r.replace(/#.*/g,""),r=r.replace(/\s+/g," "),r.trim()}const{setEndpoint:w,setFetchGraphQlHeaders:E,setFetchGraphQlHeader:P,getFetchGraphQlHeader:y,removeFetchGraphQlHeader:A,fetchGraphQl:C,getConfig:B,addBeforeHook:M,addAfterHook:O}=n.getMethods();export{v as FetchGraphQL,O as addAfterHook,M as addBeforeHook,C as fetchGraphQl,B as getConfig,y as getFetchGraphQlHeader,A as removeFetchGraphQlHeader,w as setEndpoint,P as setFetchGraphQlHeader,E as setFetchGraphQlHeaders};
//# sourceMappingURL=fetch-graphql.js.map
