/*! Copyright 2025 Adobe
All Rights Reserved. */
import{useState as a,useCallback as r,useEffect as w}from"@dropins/tools/preact-hooks.js";import{u as q}from"./useCompanyContextListener.js";import{g as A,a as B,c as J,u as K,d as M,i as Q}from"./isCompanyRoleNameAvailable.js";const V=20,$=(I=V,u=!0,C=!1)=>{const[S,n]=a([]),[z,R]=a([]),[L,f]=a(0),[m,l]=a(1),[y,D]=a(I),[F,p]=a(1),[N,d]=a(!1),[T,P]=a(!1),[b,E]=a(!1),[k,h]=a(!1),[U,s]=a(null),o=r(async(t={})=>{d(!0),s(null);try{if(C){const e=await A({pageSize:1e3,currentPage:1,...t});n(e.items),f(e.totalCount),p(1),l(1)}else{const e=await A({pageSize:y,currentPage:m,...t});n(e.items),f(e.totalCount),p(e.pageInfo.totalPages),l(e.pageInfo.currentPage)}}catch(e){s(e instanceof Error?e.message:"Failed to fetch roles")}finally{d(!1)}},[C,y,m]),c=r(async()=>{try{const t=await B();R(t)}catch(t){s(t instanceof Error?t.message:"Failed to fetch ACL resources")}},[]),v=r(async t=>{P(!0),s(null);try{const e=await J(t);return await o(),e}catch(e){return s(e instanceof Error?e.message:"Failed to create role"),null}finally{P(!1)}},[o]),x=r(async t=>{E(!0),s(null);try{const e=await K(t);return n(i=>i.map(g=>g.id===e.id?e:g)),e}catch(e){return s(e instanceof Error?e.message:"Failed to update role"),null}finally{E(!1)}},[]),_=r(async t=>{h(!0),s(null);try{const e=await M({id:t});return e&&(n(i=>i.filter(g=>g.id!==t)),f(i=>i-1)),e}catch(e){return s(e instanceof Error?e.message:"Failed to delete role"),!1}finally{h(!1)}},[]),G=r(async t=>{try{return await Q({name:t})}catch(e){return s(e instanceof Error?e.message:"Failed to check role name availability"),!1}},[]),H=r(t=>{l(t)},[]),O=r(t=>{D(t),l(1)},[]),Z=r(async()=>{await Promise.all([o(),c()])},[o,c]),j=r(()=>{s(null)},[]);return w(()=>{u&&o()},[o,u]),w(()=>{u&&c()},[c,u]),q(r(()=>{l(1),n([]),R([]),f(0),p(0),d(!0)},[]),{eager:!0}),{roles:S,aclResources:z,totalCount:L,currentPage:m,pageSize:y,totalPages:F,isLoading:N,isCreating:T,isUpdating:b,isDeleting:k,error:U,fetchRoles:o,fetchAclResources:c,createRole:v,updateRole:x,deleteRole:_,checkRoleNameAvailability:G,setPage:H,setPageSize:O,refresh:Z,clearError:j}};export{V as D,$ as u};
//# sourceMappingURL=useCompanyRoles.js.map
