/*! Copyright 2025 Adobe
All Rights Reserved. */
import{useState as a,useCallback as r,useEffect as h}from"@dropins/tools/preact-hooks.js";import{u as q}from"./useCompanyContextListener.js";import{g as A,a as B,c as J,u as K,d as M,i as Q}from"./isCompanyRoleNameAvailable.js";const V=20,$=(I=V,i=!0,d=!1)=>{const[T,u]=a([]),[S,z]=a([]),[L,m]=a(0),[g,n]=a(1),[y,D]=a(I),[F,C]=a(1),[N,R]=a(!1),[b,P]=a(!1),[k,w]=a(!1),[U,E]=a(!1),[v,s]=a(null),o=r(async(t={})=>{R(!0),s(null);try{if(d){const e=await A({pageSize:1e3,currentPage:1,...t});u(e.items),m(e.totalCount),C(1),n(1)}else{const e=await A({pageSize:y,currentPage:g,...t});u(e.items),m(e.totalCount),C(e.pageInfo.totalPages),n(e.pageInfo.currentPage)}}catch(e){s(e instanceof Error?e.message:"Failed to fetch roles")}finally{R(!1)}},[d,y,g]),l=r(async()=>{try{const t=await B();z(t)}catch(t){s(t instanceof Error?t.message:"Failed to fetch ACL resources")}},[]),x=r(async t=>{P(!0),s(null);try{const e=await J(t);return await o(),e}catch(e){return s(e instanceof Error?e.message:"Failed to create role"),null}finally{P(!1)}},[o]),_=r(async t=>{w(!0),s(null);try{const e=await K(t);return u(c=>c.map(f=>f.id===e.id?e:f)),e}catch(e){return s(e instanceof Error?e.message:"Failed to update role"),null}finally{w(!1)}},[]),G=r(async t=>{E(!0),s(null);try{const e=await M({id:t});return e&&(u(c=>c.filter(f=>f.id!==t)),m(c=>c-1)),e}catch(e){return s(e instanceof Error?e.message:"Failed to delete role"),!1}finally{E(!1)}},[]),H=r(async t=>{try{return await Q({name:t})}catch(e){return s(e instanceof Error?e.message:"Failed to check role name availability"),!1}},[]),O=r(t=>{n(t)},[]),Z=r(t=>{D(t),n(1)},[]),p=r(async()=>{await Promise.all([o(),l()])},[o,l]),j=r(()=>{s(null)},[]);return h(()=>{if(i){const t=setTimeout(()=>{o()},100);return()=>clearTimeout(t)}},[o,i]),h(()=>{if(i){const t=setTimeout(()=>{l()},100);return()=>clearTimeout(t)}},[l,i]),q(r(async()=>{n(1),await p()},[p]),{eager:!0}),{roles:T,aclResources:S,totalCount:L,currentPage:g,pageSize:y,totalPages:F,isLoading:N,isCreating:b,isUpdating:k,isDeleting:U,error:v,fetchRoles:o,fetchAclResources:l,createRole:x,updateRole:_,deleteRole:G,checkRoleNameAvailability:H,setPage:O,setPageSize:Z,refresh:p,clearError:j}};export{V as D,$ as u};
//# sourceMappingURL=useCompanyRoles.js.map
