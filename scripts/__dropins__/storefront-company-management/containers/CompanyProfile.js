/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as r,jsxs as f,Fragment as J}from"@dropins/tools/preact-jsx-runtime.js";import{classes as ue,Slot as fe}from"@dropins/tools/lib.js";import{Card as K,Button as Q,Field as V,Input as S,Picker as me,Header as pe,InLineAlert as ve,ProgressSpinner as ye}from"@dropins/tools/components.js";import{useState as L,useEffect as O,useMemo as U,useRef as G,useCallback as F}from"@dropins/tools/preact-hooks.js";import{events as Ce}from"@dropins/tools/event-bus.js";import{u as Ae}from"../chunks/useCompanyContextListener.js";import{g as Ne,u as Ee}from"../chunks/updateCompany.js";import{useText as Z}from"@dropins/tools/i18n.js";import{g as ge,v as be}from"../chunks/validateCompanyEmail.js";import*as $ from"@dropins/tools/preact-compat.js";import{C as _e}from"../chunks/CompanyLoaders.js";import"../chunks/network-error.js";import"../chunks/fetch-error.js";import"../chunks/fetch-graphql.js";import"@dropins/tools/fetch-graphql.js";const Ie=({company:t,slots:e,showEditForm:i,handleShowEditForm:u})=>{const d=Z({editButton:"Company.shared.buttons.edit",noDataMessage:"Company.CompanyProfile.companyProfileCard.noDataMessage",companyName:"Company.shared.fields.companyName",email:"Company.shared.fields.email",legalName:"Company.shared.fields.legalName",vatTaxId:"Company.shared.fields.vatTaxId",resellerId:"Company.shared.fields.resellerId",legalAddress:"Company.shared.fields.legalAddress",contacts:"Company.CompanyProfile.companyProfileCard.contacts",companyAdministrator:"Company.CompanyProfile.companyProfileCard.companyAdministrator",salesRepresentative:"Company.CompanyProfile.companyProfileCard.salesRepresentative",paymentInformation:"Company.CompanyProfile.companyProfileCard.paymentInformation",shippingInformation:"Company.CompanyProfile.companyProfileCard.shippingInformation",availablePaymentMethods:"Company.CompanyProfile.companyProfileCard.availablePaymentMethods",availableShippingMethods:"Company.CompanyProfile.companyProfileCard.availableShippingMethods",noPaymentMethods:"Company.CompanyProfile.companyProfileCard.noPaymentMethods",noShippingMethods:"Company.CompanyProfile.companyProfileCard.noShippingMethods"});if(!t)return r(K,{variant:"secondary",className:"account-company-profile-card",children:r("div",{className:"account-company-profile-card__wrapper",children:r("div",{className:"account-company-profile-card__content",children:r("div",{className:"account-company-profile-card__no-data",children:r("p",{children:d.noDataMessage})})})})});const o=t.permissionsFlags||{canViewAccount:!0,canViewAddress:!0,canViewContacts:!0,canViewPaymentInformation:!0,canViewShippingInformation:!0},a=[o.canViewAccount?{name:"name",label:d.companyName,value:t.name||"",legalName:t.legalName||""}:null,o.canViewAccount?{name:"email",label:d.email,value:t.email||""}:null,o.canViewAccount?{name:"vatTaxId",label:d.vatTaxId,value:t.vatTaxId||""}:null,o.canViewAccount?{name:"resellerId",label:d.resellerId,value:t.resellerId||""}:null].filter(Boolean);return r(K,{variant:"secondary",className:ue(["account-company-profile-card",["account-company-profile-card-short",i]]),children:f("div",{className:"account-company-profile-card__wrapper",children:[r("div",{className:"account-company-profile-card__actions",children:(t.canEditAccount||t.canEditAddress)&&r(Q,{type:"button",variant:"tertiary",onClick:u,children:d.editButton})}),r("div",{className:"account-company-profile-card__content",children:(()=>{var A,l;const v=f(J,{children:[a.map((s,c)=>{if(!s.value)return null;let C;return s.name==="name"&&s.legalName?C=`${s.label}: ${s.value} (${s.legalName})`:C=s.label?`${s.label}: ${s.value}`:s.value,r("p",{"data-testid":`${s.name}_${c}`,children:C},`${s.name}_${c}`)}),o.canViewAddress&&t.legalAddress&&f("div",{className:"company-legal-address",children:[r("p",{children:f("strong",{children:[d.legalAddress,":"]})}),(A=t.legalAddress.street)==null?void 0:A.map((s,c)=>r("p",{children:s},c)),f("p",{children:[t.legalAddress.city,", ",(l=t.legalAddress.region)==null?void 0:l.region," ",t.legalAddress.postcode]}),r("p",{children:t.legalAddress.countryCode}),t.legalAddress.telephone&&f("p",{children:["Phone: ",t.legalAddress.telephone]})]}),o.canViewContacts&&(t.companyAdmin||t.salesRepresentative)&&f("div",{className:"company-contacts",children:[r("p",{children:f("strong",{children:[d.contacts,":"]})}),t.companyAdmin&&f("div",{className:"company-contact",children:[r("p",{children:f("strong",{children:[d.companyAdministrator,":"]})}),f("p",{children:[t.companyAdmin.firstname," ",t.companyAdmin.lastname]}),t.companyAdmin.jobTitle&&r("p",{children:t.companyAdmin.jobTitle}),r("p",{children:t.companyAdmin.email})]}),t.salesRepresentative&&f("div",{className:"company-contact",children:[r("p",{children:f("strong",{children:[d.salesRepresentative,":"]})}),f("p",{children:[t.salesRepresentative.firstname," ",t.salesRepresentative.lastname]}),r("p",{children:t.salesRepresentative.email})]})]}),o.canViewPaymentInformation&&f("div",{className:"company-payment-methods",children:[r("p",{children:f("strong",{children:[d.paymentInformation,":"]})}),t.availablePaymentMethods&&t.availablePaymentMethods.length>0?f(J,{children:[r("p",{children:f("strong",{children:[d.availablePaymentMethods,":"]})}),r("ul",{className:"payment-methods-list",children:t.availablePaymentMethods.map((s,c)=>r("li",{children:s.title},`payment_${c}`))})]}):r("div",{className:"message message-notice notice",children:r("div",{children:d.noPaymentMethods})})]}),o.canViewShippingInformation&&f("div",{className:"company-shipping-methods",children:[r("p",{children:f("strong",{children:[d.shippingInformation,":"]})}),t.availableShippingMethods&&t.availableShippingMethods.length>0?f(J,{children:[r("p",{children:f("strong",{children:[d.availableShippingMethods,":"]})}),r("ul",{className:"shipping-methods-list",children:t.availableShippingMethods.map((s,c)=>r("li",{children:s.title},`shipping_${c}`))})]}):r("div",{className:"message message-notice notice",children:r("div",{children:d.noShippingMethods})})]})]});return e!=null&&e.CompanyData?r(fe,{name:"CompanyData",slot:e.CompanyData,context:{companyData:a,Default:v}}):v})()})]})})};var he=(t=>(t.EDIT_COMPANY_EVENT="edit-company",t))(he||{});const we={EDIT_COMPANY_EVENT:"edit-company"},xe=()=>(window.adobeDataLayer||(window.adobeDataLayer=[]),window.adobeDataLayer),Te=t=>{xe().push(i=>{const u=i.getState?i.getState():{};i.push({event:t,context:u})})},$e=(t,e)=>{if(!we[t])return null;switch(t){case"edit-company":Te({type:"company",eventType:"edit",companyData:e});break;default:return null}},Le=t=>{const[e,i]=L(null),[u,d]=L(!0);O(()=>{let l=!0;return ge().then(({availableCountries:s,countriesWithRequiredRegion:c,optionalZipCountries:C})=>{l&&(i({availableCountries:s,countriesWithRequiredRegion:c,optionalZipCountries:C}),d(!1))}).catch(()=>{l&&d(!1)}),()=>{l=!1}},[]);const o=U(()=>(e==null?void 0:e.availableCountries)||[],[e]),a=U(()=>{if(!t||!e)return[];const l=e.availableCountries.find(s=>s.value===t);return!(l!=null&&l.availableRegions)||l.availableRegions.length===0?[]:l.availableRegions.map(s=>({text:s.name,value:`${s.code},${s.id}`}))},[t,e]),v=U(()=>!t||!e?!1:e.countriesWithRequiredRegion.includes(t),[t,e]),A=U(()=>a.length>0,[a]);return{countryOptions:o,regionOptions:a,isRegionRequired:v,hasRegionOptions:A,loadingCountries:u}},Me=({loading:t,value:e,errors:i,touched:u,onBlur:d,namePrefix:o="",fieldPathPrefix:a=""})=>{const v=Z({companyName:"Company.shared.fields.companyName",email:"Company.shared.fields.email",legalName:"Company.shared.fields.legalName",vatTaxId:"Company.shared.fields.vatTaxId",resellerId:"Company.shared.fields.resellerId"}),A=o?`${o}_`:"",l=s=>a?`${a}.${s}`:s;return f("div",{className:"account-edit-company-profile-form__group",children:[r(V,{label:v.companyName,required:!0,className:"account-edit-company-profile-form__field",error:u.name&&i.name?i.name:void 0,children:r(S,{name:`${A}name`,type:"text",value:e.name,onBlur:s=>{const c=s.target;d(l("name"),c.value)},disabled:!!t,variant:"primary",size:"medium",maxLength:40})}),r(V,{label:v.legalName,className:"account-edit-company-profile-form__field",children:r(S,{name:`${A}legalName`,type:"text",value:e.legalName,onBlur:s=>{const c=s.target;d(l("legalName"),c.value)},disabled:!!t,variant:"primary",size:"medium",maxLength:80})}),r(V,{label:v.email,required:!0,className:"account-edit-company-profile-form__field",error:u.email&&i.email?i.email:void 0,children:r(S,{name:`${A}email`,type:"email",value:e.email,onBlur:s=>{const c=s.target;d(l("email"),c.value)},disabled:!!t,variant:"primary",size:"medium"})}),r(V,{label:v.vatTaxId,className:"account-edit-company-profile-form__field",children:r(S,{name:`${A}vatTaxId`,type:"text",value:e.vatTaxId,onBlur:s=>{const c=s.target;d(l("vatTaxId"),c.value)},disabled:!!t,variant:"primary",size:"medium",maxLength:40})}),r(V,{label:v.resellerId,className:"account-edit-company-profile-form__field",children:r(S,{name:`${A}resellerId`,type:"text",value:e.resellerId,onBlur:s=>{const c=s.target;d(l("resellerId"),c.value)},disabled:!!t,variant:"primary",size:"medium",maxLength:40})})]})},Pe=({loading:t,loadingCountries:e,value:i,errors:u,touched:d,onChange:o,onBlur:a,countryOptions:v,regionOptions:A,isRegionRequired:l,hasRegionOptions:s,namePrefix:c="legalAddress",fieldPathPrefix:C="legalAddress",requiredConfig:N})=>{var k;const _=Z({legalAddress:"Company.shared.fields.legalAddress",streetAddress:"Company.shared.fields.streetAddress",city:"Company.shared.fields.city",country:"Company.shared.fields.country",stateProvince:"Company.shared.fields.stateProvince",zipPostalCode:"Company.shared.fields.zipPostalCode",phoneNumber:"Company.shared.fields.phoneNumber"}),R={street:`${c}_street`,street2:`${c}_street2`,city:`${c}_city`,countryCode:`${c}_countryCode`,region:`${c}_region`,postcode:`${c}_postcode`,telephone:`${c}_telephone`},h={street:`${C}.street`,street2:`${C}.street2`,city:`${C}.city`,countryCode:`${C}.countryCode`,region:`${C}.region`,regionCode:`${C}.regionCode`,postcode:`${C}.postcode`,telephone:`${C}.telephone`},H={street:(N==null?void 0:N.street)??!0,city:(N==null?void 0:N.city)??!0,postcode:(N==null?void 0:N.postcode)??!0,telephone:(N==null?void 0:N.telephone)??!0};return f("div",{className:"account-edit-company-profile-form__section",children:[r("h3",{className:"account-edit-company-profile-form__section-title",children:_.legalAddress}),r(V,{label:_.streetAddress,required:H.street,className:"account-edit-company-profile-form__field",error:d[h.street]&&u[h.street]?u[h.street]:void 0,children:r(S,{name:R.street,type:"text",value:i.street,onBlur:p=>{const E=p.target;a(h.street,E.value)},disabled:!!t,variant:"primary",size:"medium"})}),r(V,{label:`${_.streetAddress} 2`,className:"account-edit-company-profile-form__field",children:r(S,{name:R.street2,type:"text",value:i.street2,onBlur:p=>{const E=p.target;a(h.street2,E.value)},disabled:!!t,variant:"primary",size:"medium"})}),r(V,{label:_.city,required:H.city,className:"account-edit-company-profile-form__field",error:d[h.city]&&u[h.city]?u[h.city]:void 0,children:r(S,{name:R.city,type:"text",value:i.city,onBlur:p=>{const E=p.target;a(h.city,E.value)},disabled:!!t,variant:"primary",size:"medium"})}),r(V,{label:_.country,required:!0,className:"account-edit-company-profile-form__field",error:d[h.countryCode]&&u[h.countryCode]?u[h.countryCode]:void 0,children:r(me,{name:R.countryCode,floatingLabel:`${_.country} *`,placeholder:_.country,options:v,value:i.countryCode,handleSelect:p=>{const E=p.target;o(h.countryCode)(E.value)},onBlur:()=>a(h.countryCode),disabled:!!t||e})}),r(V,{label:_.stateProvince,required:l,className:"account-edit-company-profile-form__field",error:d["legalAddress.region"]&&u["legalAddress.region"]?u["legalAddress.region"]:void 0,children:s?r(me,{name:"legalAddress_region",floatingLabel:`${_.stateProvince} ${l?"*":""}`,placeholder:_.stateProvince,options:A,value:i.regionCode&&((k=A.find(p=>p.value.split(",")[0]===i.regionCode))==null?void 0:k.value)||"",handleSelect:p=>{var M;const E=p.target,[B]=E.value.split(","),W=((M=A.find(z=>z.value===E.value))==null?void 0:M.text)||"";o(h.region)(W),o(h.regionCode)(B)},onBlur:()=>a(h.region),disabled:!!t||e},`region_picker_${i.countryCode}`):r(S,{name:R.region,type:"text",value:i.region,onBlur:p=>{const E=p.target;a(h.region,E.value)},disabled:!!t||e,variant:"primary",size:"medium"},`region_input_${i.countryCode}`)}),r(V,{label:_.zipPostalCode,required:H.postcode,className:"account-edit-company-profile-form__field",error:d[h.postcode]&&u[h.postcode]?u[h.postcode]:void 0,children:r(S,{name:R.postcode,type:"text",value:i.postcode,onBlur:p=>{const E=p.target;a(h.postcode,E.value)},disabled:!!t,variant:"primary",size:"medium"})}),r(V,{label:_.phoneNumber,required:H.telephone,className:"account-edit-company-profile-form__field",error:d[h.telephone]&&u[h.telephone]?u[h.telephone]:void 0,children:r(S,{name:R.telephone,type:"tel",value:i.telephone,onBlur:p=>{const E=p.target;a(h.telephone,E.value)},disabled:!!t,variant:"primary",size:"medium"})})]})},Ve=({inLineAlertProps:t,company:e,loading:i=!1,onSubmit:u,onCancel:d})=>{var j,Y,q,y,D,X,ee,te,re,ae,se,le,ne,oe;const o=Z({title:"Company.EditCompanyProfile.title",cancel:"Company.shared.buttons.cancel",save:"Company.shared.buttons.save",saving:"Company.shared.buttons.saving",required:"Company.shared.validation.required",invalidEmail:"Company.shared.validation.invalidEmail",companyNameRequired:"Company.shared.validation.companyNameRequired",emailRequired:"Company.shared.validation.emailRequired",emailNotAvailable:"Company.shared.validation.emailNotAvailable",companyNameLengthError:"Company.shared.validation.companyNameLengthError",legalNameLengthError:"Company.shared.validation.legalNameLengthError",vatTaxIdLengthError:"Company.shared.validation.vatTaxIdLengthError",resellerIdLengthError:"Company.shared.validation.resellerIdLengthError"}),[a,v]=L({name:(e==null?void 0:e.name)||"",email:(e==null?void 0:e.email)||"",legalName:(e==null?void 0:e.legalName)||"",vatTaxId:(e==null?void 0:e.vatTaxId)||"",resellerId:(e==null?void 0:e.resellerId)||"",legalAddress:{street:((Y=(j=e==null?void 0:e.legalAddress)==null?void 0:j.street)==null?void 0:Y[0])||"",street2:((y=(q=e==null?void 0:e.legalAddress)==null?void 0:q.street)==null?void 0:y[1])||"",city:((D=e==null?void 0:e.legalAddress)==null?void 0:D.city)||"",region:((ee=(X=e==null?void 0:e.legalAddress)==null?void 0:X.region)==null?void 0:ee.region)||"",regionCode:((re=(te=e==null?void 0:e.legalAddress)==null?void 0:te.region)==null?void 0:re.regionCode)||"",countryCode:((ae=e==null?void 0:e.legalAddress)==null?void 0:ae.countryCode)||"",postcode:((se=e==null?void 0:e.legalAddress)==null?void 0:se.postcode)||"",telephone:((le=e==null?void 0:e.legalAddress)==null?void 0:le.telephone)||""}}),[A,l]=L({}),[s,c]=L({}),C=((ne=e==null?void 0:e.permissionsFlags)==null?void 0:ne.canEditAccount)===!0,N=((oe=e==null?void 0:e.permissionsFlags)==null?void 0:oe.canEditAddress)===!0,{countryOptions:_,regionOptions:R,isRegionRequired:h,hasRegionOptions:H,loadingCountries:k}=Le(a.legalAddress.countryCode),p=(n,m)=>n==="name"?m.trim()?m.length>40?o.companyNameLengthError:null:o.companyNameRequired:n==="email"?m.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(m)?null:o.invalidEmail:o.emailRequired:n==="legalName"?m.length>80?o.legalNameLengthError:null:n==="vatTaxId"?m.length>40?o.vatTaxIdLengthError:null:n==="resellerId"?m.length>40?o.resellerIdLengthError:null:n==="legalAddress.street"||n==="legalAddress.city"||n==="legalAddress.postcode"||n==="legalAddress.telephone"||n==="legalAddress.countryCode"?m.trim()?null:o.required:n==="legalAddress.region"&&h&&!m.trim()?o.required:null,E=()=>{var T,P;const n={};let m=!0;const x=((T=e==null?void 0:e.permissionsFlags)==null?void 0:T.canEditAccount)===!0,g=((P=e==null?void 0:e.permissionsFlags)==null?void 0:P.canEditAddress)===!0;if(x){const b=p("name",a.name);b&&(n.name=b,m=!1);const I=p("email",a.email);if(I&&(n.email=I,m=!1),a.legalName){const w=p("legalName",a.legalName);w&&(n.legalName=w,m=!1)}if(a.vatTaxId){const w=p("vatTaxId",a.vatTaxId);w&&(n.vatTaxId=w,m=!1)}if(a.resellerId){const w=p("resellerId",a.resellerId);w&&(n.resellerId=w,m=!1)}}if(g){const b=p("legalAddress.street",a.legalAddress.street);b&&(n["legalAddress.street"]=b,m=!1);const I=p("legalAddress.city",a.legalAddress.city);I&&(n["legalAddress.city"]=I,m=!1);const w=p("legalAddress.postcode",a.legalAddress.postcode);w&&(n["legalAddress.postcode"]=w,m=!1);const ie=p("legalAddress.telephone",a.legalAddress.telephone);ie&&(n["legalAddress.telephone"]=ie,m=!1);const de=p("legalAddress.countryCode",a.legalAddress.countryCode);de&&(n["legalAddress.countryCode"]=de,m=!1);const ce=p("legalAddress.region",a.legalAddress.region);ce&&(n["legalAddress.region"]=ce,m=!1)}return l(n),m},B=async n=>{var T,P;n.preventDefault();const m=((T=e==null?void 0:e.permissionsFlags)==null?void 0:T.canEditAccount)===!0,x=((P=e==null?void 0:e.permissionsFlags)==null?void 0:P.canEditAddress)===!0,g={};if(m&&(g.name=!0,g.email=!0,g.legalName=!0,g.vatTaxId=!0,g.resellerId=!0),x&&(g["legalAddress.street"]=!0,g["legalAddress.street2"]=!0,g["legalAddress.city"]=!0,g["legalAddress.region"]=!0,g["legalAddress.regionCode"]=!0,g["legalAddress.countryCode"]=!0,g["legalAddress.postcode"]=!0,g["legalAddress.telephone"]=!0),c(g),!!E()){if(m&&a.email!==(e==null?void 0:e.email)){const b=await be(a.email);if(!b.isValid){l(I=>({...I,email:b.error||o.emailNotAvailable}));return}}if(u){const b={};m&&(b.name=a.name,b.email=a.email,b.legalName=a.legalName,b.vatTaxId=a.vatTaxId,b.resellerId=a.resellerId),x&&(b.legalAddress={street:[a.legalAddress.street,a.legalAddress.street2].filter(Boolean),city:a.legalAddress.city,region:{region:a.legalAddress.region,regionCode:a.legalAddress.regionCode},countryCode:a.legalAddress.countryCode,postcode:a.legalAddress.postcode,telephone:a.legalAddress.telephone}),await u(b)}}},W=(n,m)=>{if(n.startsWith("legalAddress.")){const x=n.split(".")[1];x==="countryCode"?(v(g=>({...g,legalAddress:{...g.legalAddress,[x]:m,region:"",regionCode:""}})),l(g=>{const T={...g};return delete T["legalAddress.region"],delete T["legalAddress.regionCode"],T}),c(g=>{const T={...g};return delete T["legalAddress.region"],delete T["legalAddress.regionCode"],T})):v(x==="region"?g=>({...g,legalAddress:{...g.legalAddress,region:m,regionCode:H?g.legalAddress.regionCode:m}}):g=>({...g,legalAddress:{...g.legalAddress,[x]:m}}))}else v(x=>({...x,[n]:m}))},M=n=>m=>{const x=new Set(["name","email","legalName","vatTaxId","resellerId"]),g=n.startsWith("legalAddress.");x.has(n)&&!C||g&&!N||(W(n,m),A[n]&&l(P=>{const b={...P};return delete b[n],b}))},z=(n,m)=>{const x=new Set(["name","email","legalName","vatTaxId","resellerId"]),g=n.startsWith("legalAddress.");if(x.has(n)&&!C||g&&!N)return;m!==void 0&&W(n,m),c(I=>({...I,[n]:!0}));let P=m;if(P===void 0)if(n.startsWith("legalAddress.")){const I=n.split(".")[1],w=a.legalAddress[I];P=typeof w=="string"?w:""}else{const I=a[n];P=typeof I=="string"?I:""}const b=p(n,P);l(b?I=>({...I,[n]:b}):I=>{const w={...I};return delete w[n],w})};return f(K,{variant:"secondary",className:"account-edit-company-profile",children:[r(pe,{title:o.title,divider:!1,className:"account-edit-company-profile__title"}),t!=null&&t.text?r(ve,{className:"account-edit-company-profile__notification",type:t.type,variant:"secondary",heading:t.text,icon:t.icon,"data-testid":"editCompanyInLineAlert"}):null,f("form",{className:"account-edit-company-profile-form",onSubmit:B,children:[C&&r(Me,{loading:i,value:{name:a.name,email:a.email,legalName:a.legalName,vatTaxId:a.vatTaxId,resellerId:a.resellerId},errors:A,touched:s,onBlur:z}),N&&r(Pe,{loading:i,loadingCountries:k,value:a.legalAddress,errors:A,touched:s,onChange:M,onBlur:z,countryOptions:_,regionOptions:R,isRegionRequired:h,hasRegionOptions:H}),f("div",{className:"account-edit-company-profile__actions",children:[r(Q,{disabled:i,type:"button",variant:"secondary",onClick:()=>d==null?void 0:d(),children:o.cancel}),r(Q,{disabled:i||!C&&!N,type:"submit",variant:"primary",children:o.save})]})]}),i&&f("div",{className:"account-edit-company-profile__loading-overlay","data-testid":"editCompanyLoadingOverlay",children:[r(ye,{size:"large"}),r("div",{className:"account-edit-company-profile__loading-text",children:o.saving})]})]})},Fe=t=>$.createElement("svg",{id:"Icon_Warning_Base",width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},$.createElement("g",{clipPath:"url(#clip0_841_1324)"},$.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.9949 2.30237L0.802734 21.6977H23.1977L11.9949 2.30237Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M12.4336 10.5504L12.3373 14.4766H11.6632L11.5669 10.5504V9.51273H12.4336V10.5504ZM11.5883 18.2636V17.2687H12.4229V18.2636H11.5883Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})),$.createElement("defs",null,$.createElement("clipPath",{id:"clip0_841_1324"},$.createElement("rect",{width:24,height:21,fill:"white",transform:"translate(0 1.5)"})))),Re=t=>$.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},$.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M0.75 12C0.75 5.78421 5.78421 0.75 12 0.75C18.2158 0.75 23.25 5.78421 23.25 12C23.25 18.2158 18.2158 23.25 12 23.25C5.78421 23.25 0.75 18.2158 0.75 12Z",stroke:"currentColor"}),$.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M6.75 12.762L10.2385 15.75L17.25 9",stroke:"currentColor"})),De=t=>$.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},$.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M0.75 12C0.75 5.78421 5.78421 0.75 12 0.75C18.2158 0.75 23.25 5.78421 23.25 12C23.25 18.2158 18.2158 23.25 12 23.25C5.78421 23.25 0.75 18.2158 0.75 12Z",stroke:"currentColor"}),$.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.75 5.88423V4.75H12.25V5.88423L12.0485 13.0713H11.9515L11.75 5.88423ZM11.7994 18.25V16.9868H12.2253V18.25H11.7994Z",stroke:"currentColor"})),Se=({handleSetInLineAlert:t,editFormRef:e})=>{const i=Z({companySuccess:"Company.CompanyProfile.editCompanyProfile.companySuccess",companyError:"Company.CompanyProfile.editCompanyProfile.companyError",loadError:"Company.CompanyProfile.messages.loadError",updateError:"Company.CompanyProfile.messages.updateError"}),{companySuccess:u,companyError:d,loadError:o,updateError:a}=i,[v,A]=L(null),[l,s]=L(!0),[c,C]=L(!1),[N,_]=L(!1),[R,h]=L([]),[H,k]=L({}),p=G(t),E=G(!1),B=G(!1);O(()=>{p.current=t},[t]);const W=F(y=>{k(y)},[]),M=F((y,D)=>{t&&(y==="success"?t({type:"success",text:D??u}):y==="error"?t({type:"error",text:D??d}):t(),C(!1))},[t,u,d]),z=F(async()=>{if(E.current)return null;E.current=!0,s(!0);try{const y=await Ne();return y&&A(y),s(!1),y}catch(y){return console.error("Failed to load company:",y),s(!1),p.current&&p.current({type:"error",text:o}),null}finally{E.current=!1}},[o]);O(()=>{B.current||(B.current=!0,z())},[z]),Ae(F(()=>{s(!0),_(!1),k({}),z()},[z])),O(()=>{ge().then(y=>{h(y.availableCountries)}).catch(y=>{console.error("Failed to load countries:",y)})},[]);const j=F(()=>{_(!0),M("success",""),k({})},[M]);O(()=>{N&&(e!=null&&e.current)&&setTimeout(()=>{var y;(y=e.current)==null||y.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)},[N,e]);const Y=F(y=>{y==null||y(),_(!1),k({})},[]),q=F(async y=>{try{if(C(!0),!y){M("error","No data to update");return}const D=await Ee(y);A(D),_(!1),k({}),M("success"),$e(he.EDIT_COMPANY_EVENT,{...y,companyId:v==null?void 0:v.id}),Ce.emit("company/updated",{company:D})}catch(D){console.error("Failed to update company:",D),M("error",D.message||a)}finally{C(!1)}},[v,M,a]);return{company:v,countries:R,loading:l,submitLoading:c,showEditForm:N,inputChange:H,handleShowEditForm:j,handleHideEditForm:Y,handleUpdateCompany:q,handleInputChange:W,renderAlertMessage:M,saving:c}},ke={success:r(Re,{}),warning:r(Fe,{}),error:r(De,{})},He=()=>{const[t,e]=L({}),[i,u]=L(null),d=F(()=>{e({}),i&&(clearTimeout(i),u(null))},[i]),o=F(l=>{if(i&&(clearTimeout(i),u(null)),!(l!=null&&l.type)){e({});return}const s=ke[l.type];if(e({type:l.type,text:l.text,icon:s}),l.autoHide!==!1){const c=l.autoHideDelay||(l.type==="success"?3e3:5e3),C=setTimeout(()=>{e({}),u(null)},c);u(C)}},[i]),a=F((l,s=!0)=>{o({type:"success",text:l,autoHide:s})},[o]),v=F((l,s=!1)=>{o({type:"warning",text:l,autoHide:s})},[o]),A=F((l,s=!1)=>{o({type:"error",text:l,autoHide:s})},[o]);return O(()=>()=>{i&&clearTimeout(i)},[i]),{inLineAlertProps:t,handleSetInLineAlert:o,clearAlert:d,showSuccess:a,showWarning:v,showError:A}},et=({className:t,withHeader:e=!0,slots:i})=>{const u=Z({containerTitle:"Company.CompanyProfile.containerTitle"}),{inLineAlertProps:d,handleSetInLineAlert:o}=He(),a=G(null),{company:v,loading:A,saving:l,showEditForm:s,handleShowEditForm:c,handleHideEditForm:C,handleUpdateCompany:N}=Se({handleSetInLineAlert:o,editFormRef:a});return A?r("div",{"data-testid":"companyProfileLoader",children:r(_e,{withCard:!0})}):f("div",{className:ue(["account-company-profile",t]),children:[e?r(pe,{title:u.containerTitle,divider:!1,className:"company-profile__title"}):null,r(Ie,{company:v,slots:i,showEditForm:s,handleShowEditForm:c}),s?r("div",{ref:a,children:r(Ve,{inLineAlertProps:d,company:v,loading:l,onSubmit:N,onCancel:C})}):null]})};export{et as CompanyProfile,et as default};
//# sourceMappingURL=CompanyProfile.js.map
