/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsxs as p,Fragment as j,jsx as s}from"@dropins/tools/preact-jsx-runtime.js";import{InLineAlert as H,Table as U,Pagination as V,Picker as W,Card as B,Header as L}from"@dropins/tools/components.js";import{classes as y}from"@dropins/tools/lib.js";import{events as w}from"@dropins/tools/event-bus.js";/* empty css                                */import{useText as z,Text as h}from"@dropins/tools/i18n.js";import{useState as I,useEffect as q,useMemo as G}from"@dropins/tools/preact-hooks.js";const se=e=>{try{return new URL(e,window.location.origin).origin===window.location.origin}catch{return e.startsWith("/")||e.startsWith("./")||e.startsWith("../")}},J=(e,a,r)=>{if(r<=0)return{from:0,to:0,total:0};const o=Math.max(1,Math.ceil(r/a)),i=Math.min(Math.max(e,1),o),l=(i-1)*a+1,t=Math.min(i*a,r);return{from:l,to:t,total:r}},te=({pageSizeConfig:e,totalCount:a=0,columns:r=[],rows:o=[],paginationConfig:i,alertMessageConfig:l={heading:"",description:"",type:"success"},loading:t=!1,className:c="",variant:M="secondary",skeletonRowCount:x=10,emptyTitle:A,header:m,footer:b,withWrapper:k})=>{var O;const C=z({title:"PurchaseOrders.purchaseOrdersTable.noPurchaseOrders.default"}),{heading:f,description:v,type:N}=l,{currentPage:P,totalPages:g,handlePageChange:T}=i,{pageSizeOptionsList:n,onChange:R}=e,d=n==null?void 0:n.find(u=>u.selected),D=d&&d.value!==void 0?Number(d.value):0,{from:E,to:F,total:S}=J(P,D,a),_=p(j,{children:[f||v?s(H,{heading:f,description:v,type:N}):null,m?s("div",{className:"purchase-orders-table__header",children:m}):null,s(U,{className:"purchase-orders-table__table-wrapper",mobileLayout:"stacked",columns:r,rowData:o,loading:t,skeletonRowCount:+x}),!t&&o.length===0&&s("div",{className:"purchase-orders-table__empty-state",role:"status","aria-live":"polite",children:s("p",{children:A||C.title})}),a>0?p("div",{className:"purchase-orders-table__pagination-wrapper",children:[s("div",{className:"purchase-orders-table__pagination-counter",children:s(h,{id:"PurchaseOrders.purchaseOrdersTable.pagination.status",fields:{from:E,to:F,total:S}})}),g>1&&s(V,{className:"purchase-orders-table__pagination",currentPage:P,totalPages:g,onChange:T}),a>0&&n.length?p("div",{className:"purchase-orders-table__pagination-page-size",children:[s(h,{id:"PurchaseOrders.purchaseOrdersTable.pagination.pageSizeLabel.start"}),s(W,{disabled:t,handleSelect:R,options:n,value:((O=n==null?void 0:n.find(u=>u.selected))==null?void 0:O.value)||""}),s(h,{id:"PurchaseOrders.purchaseOrdersTable.pagination.pageSizeLabel.end"})]}):null]}):null,b?s("div",{className:"purchase-orders-table__footer",children:b}):null]});return k?s(B,{variant:M,"data-testid":"purchaseOrdersTable",className:y(["b2b-purchase-order-purchase-orders-table",c]),children:_}):s("div",{"data-testid":"purchaseOrdersTable",className:y(["b2b-purchase-order-purchase-orders-table",c]),children:_})},oe=({headerText:e})=>s(L,{title:e,divider:!1,className:"purchase-orders-header","data-testid":"purchase-orders-header"}),le=[{text:"10",value:"10",selected:!1},{text:"20",value:"20",selected:!0},{text:"30",value:"30",selected:!1},{text:"50",value:"50",selected:!1}],K=[{key:"action",label:"Action"},{key:"poNumber",label:"PO #"},{key:"orderNumber",label:"Order #"},{key:"status",label:"Status"},{key:"createdBy",label:"Created By"},{key:"total",label:"Total"},{key:"createdDate",label:"Created"},{key:"updatedDate",label:"Updated"}],ne=[{key:"checkboxView",label:""},...K],Q=e=>{if(!e)return{isAdmin:!1,purchaseOrderEnabled:!1,role:{id:"",name:""},permissions:{purchaseOrderAll:!1,viewPurchaseOrders:!1,viewPurchaseOrdersForSubordinates:!1,viewPurchaseOrdersForCompany:!1,autoApprovePurchaseOrder:!1,superApprovePurchaseOrder:!1,viewApprovalRules:!1,manageApprovalRules:!1}};const a=e.admin===!0,r=t=>{const c=e[t];return c===!1?!1:c===!0?!0:a},o={purchaseOrderAll:r("Magento_PurchaseOrder::all"),viewPurchaseOrders:r("Magento_PurchaseOrder::view_purchase_orders"),viewPurchaseOrdersForSubordinates:r("Magento_PurchaseOrder::view_purchase_orders_for_subordinates"),viewPurchaseOrdersForCompany:r("Magento_PurchaseOrder::view_purchase_orders_for_company"),autoApprovePurchaseOrder:r("Magento_PurchaseOrder::autoapprove_purchase_order"),superApprovePurchaseOrder:r("Magento_PurchaseOrderRule::super_approve_purchase_order"),viewApprovalRules:r("Magento_PurchaseOrderRule::view_approval_rules"),manageApprovalRules:r("Magento_PurchaseOrderRule::manage_approval_rules")},l=Object.values(e).some(t=>t===!1)?!1:Object.values(o).some(t=>t===!0);return{isAdmin:a,purchaseOrderEnabled:l,role:{id:"",name:a?"Company Administrator":""},permissions:o}},ie=()=>{const e=w.lastPayload("auth/permissions"),[a,r]=I(e);q(()=>{const l=w.on("auth/permissions",t=>{r(t)},{eager:!0});return()=>{l==null||l.off()}},[]);const o=!a;return{permissions:G(()=>Q(a),[a]),loadingPermissions:o}};export{oe as P,te as a,ne as b,K as c,le as d,se as i,ie as u};
//# sourceMappingURL=useCustomerRolePermissions.js.map
