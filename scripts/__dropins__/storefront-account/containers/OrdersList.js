/*! Copyright 2026 Adobe
All Rights Reserved. */
import{jsx as e,jsxs as h,Fragment as k}from"@dropins/tools/preact-jsx-runtime.js";import{classes as P,Slot as H}from"@dropins/tools/lib.js";import{S as F,c as j,E as R,C as Q}from"../chunks/AddressValidation.js";import"@dropins/tools/preact-compat.js";import{Card as G,Icon as m,Image as J,Price as X,ContentGrid as Z,Header as rr,Picker as er,Pagination as tr}from"@dropins/tools/components.js";import{useText as I}from"@dropins/tools/i18n.js";import{useState as y,useEffect as M,useMemo as U,useCallback as K}from"@dropins/tools/preact-hooks.js";import{events as ar}from"@dropins/tools/event-bus.js";import{g as sr}from"../chunks/getOrderHistoryList.js";import{g as nr}from"../chunks/getStoreConfig.js";import"../chunks/removeCustomerAddress.js";import"@dropins/tools/fetch-graphql.js";import"@dropins/tools/preact.js";import"../chunks/initialize.js";import"../fragments.js";const V={size:"32",stroke:"2"},W=({minifiedView:n,orderNumber:c,orderToken:r,routeOrdersList:s,routeOrderDetails:g})=>{const a=n?"minifiedView":"fullSizeView",l=I({viewAllOrdersButton:`Account.${a}.OrdersList.viewAllOrdersButton`,ariaLabelLink:`Account.${a}.OrdersList.ariaLabelLink`});return s?e("a",{className:P(["account-orders-list-action",["account-orders-list-action--minifiedView",n]]),"data-testid":"ordersListActionButtonMinifiedView",href:s(),children:e(G,{"data-testid":"ordersListActionMinifiedView",variant:"secondary",children:h("div",{className:"account-orders-list-action__card-wrapper",children:[e("p",{children:l.viewAllOrdersButton}),e(m,{source:F,...V})]})})}):e("a",{"aria-label":`${l.ariaLabelLink} ${c??r}`,href:j(g)?g(c,r):"#",className:"account-orders-list-action","data-testid":"ordersListActionButton",children:e(m,{source:F,...V})})},cr=()=>{const[n,c]=y(window.innerWidth<768);return M(()=>{const r=()=>{c(window.innerWidth<768)};return window.addEventListener("resize",r),()=>{window.removeEventListener("resize",r)}},[]),n},dr=({placeholderImage:n,minifiedView:c,item:r,withThumbnails:s,children:g,slots:a,routeTracking:l,routeOrderProduct:L,routeReturnDetails:f,...b})=>{var w,i,N,$,z,D,O,Y,C,E,v,T;const d=c?"minifiedView":"fullSizeView",u=I({orderNumber:`Account.${d}.OrdersList.OrdersListCard.orderNumber`,itemsAmount:`Account.${d}.OrdersList.OrdersListCard.itemsAmount`,carrier:`Account.${d}.OrdersList.OrdersListCard.carrier`,returnsText:`Account.${d}.OrdersList.OrdersListCard.returns`,deliveryDateText:`Account.${d}.OrdersList.OrdersListCard.orderDate`}),o=cr(),S=j(L),_=U(()=>((r==null?void 0:r.items)??[]).map((t,p)=>{var x,B;const A={title:(t==null?void 0:t.productName)??"",src:((B=(x=t==null?void 0:t.product)==null?void 0:x.smallImage)==null?void 0:B.url)||n,alt:(t==null?void 0:t.productName)??"",width:65,height:65,loading:"eager"};return e(H,{name:"OrderItemImage",slot:a==null?void 0:a.OrderItemImage,context:{data:t,defaultImageProps:A},children:S?e("a",{href:(L==null?void 0:L(t))??"",target:"_blank",rel:"noreferrer",children:e(J,{...A})}):e(J,{...A})},`${p}_${t.id}`)}),[S,r.items,n,L,a==null?void 0:a.OrderItemImage]);return h(G,{variant:"secondary",...b,className:P(["account-orders-list-card",["account-orders-list-card--full",((w=r==null?void 0:r.items)==null?void 0:w.length)>6]]),children:[e("div",{className:"account-orders-list-card__content",children:a!=null&&a.OrdersListCard?e(H,{"data-testid":`ordersListCard${r.id}`,name:"OrdersListCard",slot:a==null?void 0:a.OrdersListCard,context:{orderHistoryListItem:r}}):h(k,{children:[e("div",{children:r==null?void 0:r.status}),a!=null&&a.OrdersListOrderTime?e(H,{"data-testid":`ordersListOrderTime${r.id}`,name:"OrdersListOrderTime",slot:a==null?void 0:a.OrdersListOrderTime,context:{deliveryDateText:u.deliveryDateText,orderDate:r==null?void 0:r.orderDate,orderTime:r==null?void 0:r.orderTime}}):h("p",{children:[u.deliveryDateText," ",r==null?void 0:r.orderDate]}),h("p",{children:[u.orderNumber," ",r.number]}),(i=r==null?void 0:r.shipments)==null?void 0:i.map(t=>{var p;return(p=t==null?void 0:t.tracking)==null?void 0:p.map(A=>{const x=l==null?void 0:l(A);return h("p",{"data-testid":A.number,children:[e("span",{children:`${u.carrier} ${A.carrier.toLocaleUpperCase()} `}),x?e("a",{href:x,target:"_blank",className:"account-orders-list-card__content--track_number",rel:"noreferrer",children:A.number}):e("span",{className:"account-orders-list-card__content--track_number",children:A.number})]},t.id)})}),r!=null&&r.returns&&((N=r.returns)!=null&&N.length)?h("p",{"data-testid":r.number,children:[h("span",{children:[u.returnsText," "]}),($=r==null?void 0:r.returns)==null?void 0:$.map(t=>e("span",{"data-testid":t.number,children:h("a",{href:(f==null?void 0:f({orderNumber:r.number,orderToken:r.token,returnNumber:t.number}))??"#",className:"account-orders-list-card__content--return_number",children:[t.number," "]})},t.uid))]},r.id):null,e("p",{children:e(X,{amount:((D=(z=r==null?void 0:r.total)==null?void 0:z.grandTotal)==null?void 0:D.value)??0,currency:(Y=(O=r==null?void 0:r.total)==null?void 0:O.grandTotal)==null?void 0:Y.currency,weight:"normal",size:"medium"})}),h("p",{"data-testid":"itemsAmount",children:[(C=r==null?void 0:r.items)!=null&&C.length?(E=r==null?void 0:r.items)==null?void 0:E.reduce((t,p)=>{const A=(p==null?void 0:p.quantityOrdered)||0;return t+A},0):0," ",u.itemsAmount]}),(v=r==null?void 0:r.items)==null?void 0:v.map((t,p)=>{if(p>=0&&p<10)return h("p",{className:"account-orders-list-card__content--product-name",children:[h("span",{className:"account-orders-list-card__content--quantity",children:[(t==null?void 0:t.quantityOrdered)>1?t==null?void 0:t.quantityOrdered:null," "]}),t==null?void 0:t.productName.replaceAll("-"," ")]},`${p}_${t.id}`);if(p===11)return e("p",{children:"..."},"ellipsis")})]})}),s&&((T=r==null?void 0:r.items)!=null&&T.length)?e(Z,{maxColumns:o?3:9,emptyGridContent:e(k,{}),className:P(["account-orders-list-card__images",["account-orders-list-card__images-3",o]]),"data-testid":"ordersListCardImages",children:_}):null,e("div",{className:"account-orders-list-card__actions",children:g})]})},or=({ordersInMinifiedView:n,minifiedView:c,pageSize:r,selectedDate:s,selectedPage:g,handleSetFirstOrderDate:a})=>{const[l,L]=y([]),[f,b]=y({totalPages:1,currentPage:1,pageSize:1}),[d,u]=y(!1),[o,S]=y(""),[_,w]=y(0);return M(()=>{nr().then(i=>{S(i.baseMediaUrl)})},[]),M(()=>{const i=ar.on("companyContext/changed",()=>{w(N=>N+1)});return()=>{i==null||i.off()}},[]),M(()=>{u(!0),sr(c?n:r,s,g).then(i=>{!i||!i.items||(b(i.pageInfo),L(i.items),a==null||a(i.dateOfFirstOrder))}).finally(()=>{u(!1)})},[a,c,n,r,s,g,_]),{loading:d,orderHistoryListItems:l,pageInfo:f,placeholderImage:o}},q=(n,c=1)=>{const r=new Date,s=new Date(r);switch(n){case"sixMonthsAgo":{s.setMonth(s.getMonth()-c);break}case"oneYearAgo":{s.setFullYear(s.getFullYear()-c);break}default:return""}return{from:s==null?void 0:s.toISOString().split("T")[0],to:`${r==null?void 0:r.toISOString().split("T")[0]} 23:59:59`}},ir=n=>{const c=[],r=new Date().getFullYear();for(let s=n;s<=r-1;s++)c.push({value:`{"from":"${s}-01-01","to":"${s+1}-01-01 23:59:59"}`,text:s.toString()});return c},lr=()=>{const n=I({pastSixMonths:"Account.fullSizeView.OrdersList.OrdersListSelectDate.pastSixMonths",currentYear:"Account.fullSizeView.OrdersList.OrdersListSelectDate.currentYear",viewAll:"Account.fullSizeView.OrdersList.OrdersListSelectDate.viewAll"}),[c,r]=y(),[s,g]=y(JSON.stringify(q("sixMonthsAgo",6))),[a,l]=y(1);M(()=>{window==null||window.scrollTo({top:100,behavior:"smooth"})},[a]);const L=U(()=>{const d=[{value:JSON.stringify(q("sixMonthsAgo",6)),text:n.pastSixMonths},{value:JSON.stringify(q("oneYearAgo",1)),text:n.currentYear},{value:"viewAll",text:n.viewAll}];if(c){const o=new Date(c).getFullYear();d==null||d.splice(2,0,...ir(o))}return d},[n,c]),f=K(d=>{r(d)},[]),b=K(d=>{const o=d.target.value;g(o),l(1)},[]);return{selectableDateList:L,selectedDate:s,selectedPage:a,handleSelectDate:b,setSelectedPage:l,handleSetFirstOrderDate:f}},ur=({className:n,withHeader:c=!0,minifiedView:r=!1,withThumbnails:s=!0,withFilter:g=!0,ordersInMinifiedView:a=1,pageSize:l=10,routeOrdersList:L,routeOrderDetails:f,routeReturnDetails:b,routeTracking:d,routeOrderProduct:u,slots:o})=>{const S=r?"minifiedView":"fullSizeView",_=I({containerTitle:`Account.${S}.OrdersList.containerTitle`,dateOrderPlaced:`Account.${S}.OrdersList.dateOrderPlaced`}),{selectableDateList:w,selectedDate:i,handleSelectDate:N,selectedPage:$,setSelectedPage:z,handleSetFirstOrderDate:D}=lr(),{pageInfo:O,loading:Y,orderHistoryListItems:C,placeholderImage:E}=or({minifiedView:r,pageSize:l,ordersInMinifiedView:a,selectedDate:i,selectedPage:$,handleSetFirstOrderDate:D});return h("div",{children:[c?e(rr,{"aria-label":_.containerTitle,role:"region",title:_.containerTitle,divider:!r,className:r?"account-orders-list-header":""}):null,h("div",{className:P(["account-orders-list",n]),children:[!r&&g?h("div",{className:"account-orders-list__date-select",children:[e("span",{children:_.dateOrderPlaced}),e(er,{value:i,name:"orderDatePicker",options:w,handleSelect:N})]}):null,Y?e(k,{children:Array.from(Array(O==null?void 0:O.pageSize).keys()).map(v=>e(Q,{testId:"orderSkeletonLoader",withCard:!1},v))}):e(k,{children:C.length?e(k,{children:C.map((v,T)=>e(dr,{placeholderImage:E,routeTracking:d,routeOrderProduct:u,routeReturnDetails:b,minifiedView:r,item:v,withThumbnails:s,slots:o,children:o!=null&&o.OrdersListAction?e(H,{"data-testid":`ordersListActionSlot_${T}`,name:"OrdersListAction",slot:o==null?void 0:o.OrdersListAction,context:{orderHistoryListItem:v}}):e(W,{minifiedView:r,orderNumber:v.number,orderToken:v.token,routeOrderDetails:f})},T))}):e(R,{isEmpty:!C.length,typeList:"orders",minifiedView:r})}),!r&&(O==null?void 0:O.totalPages)>1?e(tr,{totalPages:O==null?void 0:O.totalPages,currentPage:$,onChange:z}):null,r?e(W,{minifiedView:r,routeOrdersList:L}):null]})]})},$r=({className:n,withHeader:c,minifiedView:r,withThumbnails:s,withFilter:g,ordersInMinifiedView:a,pageSize:l,routeOrdersList:L,routeOrderDetails:f,routeReturnDetails:b,routeTracking:d,routeOrderProduct:u,slots:o})=>e("div",{className:P(["account-orders-list",n]),"data-testid":"ordersListId",children:e(ur,{className:n,withHeader:c,minifiedView:r,withThumbnails:s,withFilter:g,ordersInMinifiedView:a,pageSize:l,routeOrdersList:L,routeOrderDetails:f,routeReturnDetails:b,routeTracking:d,routeOrderProduct:u,slots:o})});export{$r as OrdersList,$r as default};
//# sourceMappingURL=OrdersList.js.map
