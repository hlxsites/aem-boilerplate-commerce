/*! Copyright 2026 Adobe
All Rights Reserved. */
import{jsxs as A,jsx as o}from"@dropins/tools/preact-jsx-runtime.js";import{TextArea as Q,Button as L}from"@dropins/tools/components.js";import{c as q,d as v,Q as M}from"../chunks/QuickOrderDisabledOverlay.js";import{useState as h,useRef as g,useEffect as p,useCallback as b,useMemo as I}from"@dropins/tools/preact-hooks.js";import{events as x}from"@dropins/tools/event-bus.js";import{c as _}from"../chunks/initialize.js";import{Slot as C,classes as N}from"@dropins/tools/lib.js";import{useText as B}from"@dropins/tools/i18n.js";import"@dropins/tools/preact-compat.js";import"@dropins/tools/fetch-graphql.js";const y=({t,onChange:i,textAreaValue:r,loading:l,disabled:u})=>A("div",{className:q(["b2b-quick-order-sku-list-input"]),children:[o("div",{className:"b2b-quick-order-sku-list-input__title",children:t.title}),o(Q,{id:"quick-order-sku-list-input",label:t.label,className:"b2b-quick-order-sku-list-input__textarea",placeholder:t.textAreaPlaceholder,onChange:i,value:r,disabled:l||u}),o("div",{className:"b2b-quick-order-sku-list-input__message",children:t.helperText})]}),R=({onChange:t})=>{const[i,r]=h(""),[l,u]=h(!1),m=g([]),a=g(!0);p(()=>()=>{a.current=!1},[]);const d=b(e=>{const n=e.split(/[\s,]+/).map(s=>s.trim()).filter(s=>s.length>0),c=new Map;n.forEach(s=>{c.set(s,(c.get(s)||0)+1)});const f=Array.from(c.entries()).map(([s,S])=>({sku:s,quantity:S}));return m.current=f,f},[]),k=I(()=>v(e=>{t&&a.current&&t(e)},300),[t]);p(()=>{k(d(i))},[i,k,d]),p(()=>{const e=x.on("quick-order/loading",n=>{a.current&&u(n)},{eager:!0});return()=>{e==null||e.off()}},[]);const O=b(e=>{const c=e.target.value;r(c)},[]),T=b(e=>{const n=m.current,c=e?[...n,...e]:n;x.emit("quick-order/add-items",c),r("")},[]);return{handleChange:O,textAreaValue:i,loading:l,handleAddToList:T}},H=({className:t,onChange:i,slots:r})=>{const l=_.getConfig().quickOrderActive,u=B({title:"QuickOrder.SkuListInput.title",helperText:"QuickOrder.SkuListInput.helperText",textAreaPlaceholder:"QuickOrder.SkuListInput.textArea.placeholder",buttonText:"QuickOrder.SkuListInput.button",label:"QuickOrder.SkuListInput.textArea.label",disabledMessage:"QuickOrder.QuickOrderItem.disabledMessage"}),{handleChange:m,textAreaValue:a,loading:d,handleAddToList:k}=R({onChange:i});return o("div",{className:N(["b2b-quick-order-quick-order-multiple-sku",t]),"data-testid":"storefrontQuickOrderTest",children:A(M,{isDisabled:!l,message:u.disabledMessage,children:[o(y,{loading:d,textAreaValue:a,onChange:m,t:u}),o(C,{"data-testid":"addToListButtonTest",name:"AddToListButton",slot:r==null?void 0:r.AddToListButton,context:{handleAddToList:k,loading:d,textAreaValue:a},children:o(L,{onClick:()=>k(),disabled:d||!a.length,children:u.buttonText})})]})})};export{H as QuickOrderMultipleSku,H as default};
//# sourceMappingURL=QuickOrderMultipleSku.js.map
