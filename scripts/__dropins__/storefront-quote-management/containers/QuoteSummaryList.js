/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as n,jsxs as v,Fragment as E}from"@dropins/tools/preact-jsx-runtime.js";import*as b from"@dropins/tools/preact-compat.js";import{useState as L,useEffect as ve,useCallback as fe}from"@dropins/tools/preact-compat.js";import{Divider as re,Skeleton as _e,SkeletonRow as xe,Button as be,CartList as Ie,Accordion as Te,AccordionSection as ke,CartItem as Qe,Price as I,Image as Ce}from"@dropins/tools/components.js";import{classes as y,VComponent as q,Slot as d}from"@dropins/tools/lib.js";import{events as we}from"@dropins/tools/event-bus.js";/* empty css                        *//* empty css                          */import"@dropins/tools/preact.js";/* empty css                        *//* empty css                                  *//* empty css                          */import{s as ie,Q as p}from"../chunks/state.js";import{S as Ee}from"../chunks/ChevronDown.js";import{useText as Ne}from"@dropins/tools/i18n.js";const Pe=f=>b.createElement("svg",{id:"Icon_Chevron_right_Base","data-name":"Icon \\u2013 Chevron right \\u2013 Base",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...f},b.createElement("g",{id:"Large"},b.createElement("rect",{id:"Placement_area","data-name":"Placement area",width:24,height:24,fill:"#fff",opacity:0}),b.createElement("g",{id:"Chevron_right_icon","data-name":"Chevron right icon"},b.createElement("path",{vectorEffect:"non-scaling-stroke",id:"chevron",d:"M199.75,367.5l4.255,-4.255-4.255,-4.255",transform:"translate(-189.25 -351.0)",fill:"none",stroke:"currentColor"})))),oe=({className:f,children:N,heading:g,footer:T,products:u,outOfStockMessage:r,loading:P=!0,variant:_="primary",...k})=>n("div",{...k,className:y(["quote-management-quote-summary-list",f,`quote-management-quote-summary-list__background--${_}`]),children:P?n(Ae,{}):v(E,{children:[(g||r)&&v("div",{"data-testid":"quote-summary-list-heading-wrapper",className:y(["quote-management-quote-summary-list__heading",["quote-management-quote-summary-list__heading--full-width",!u]]),children:[g&&v(E,{children:[n(q,{node:g,className:"quote-management-quote-summary-list__heading-text"}),n(re,{variant:"primary",className:y(["quote-management-quote-summary-list__heading-divider"])})]}),r&&n(q,{node:r,className:"quote-management-quote-summary-list__out-of-stock-message"})]}),n("div",{className:y(["quote-management-quote-summary-list__content"]),children:u}),T&&v(E,{children:[n(re,{variant:"primary",className:y(["quote-management-quote-summary-list__footer-divider"])}),n(q,{node:T,className:"quote-management-quote-summary-list__footer-text"})]})]})}),Ae=()=>n(_e,{"data-testid":"quote-summary-list-skeleton",className:"quote-management-quote-summary-list__skeleton",rowGap:"medium",children:n(xe,{variant:"row",size:"xlarge",fullWidth:!0,lines:3,multilineGap:"small"})}),We=({hideHeading:f,hideFooter:N,routeProduct:g,showMaxItems:T=!0,attributesToHide:u=[],slots:r,accordion:P=!1,variant:_="primary",showDiscount:k,showSavings:M,...O})=>{var Z,H;const[o,ce]=L(void 0),[Q,ue]=L(!0),[A,le]=L(T),R=((Z=ie.config)==null?void 0:Z.quoteSummaryMaxItems)||5,c=(H=ie.config)==null?void 0:H.quoteDisplaySettings,s=Ne({discountedPrice:"NegotiableQuote.QuoteSummaryList.discountedPrice",discountPercentage:"NegotiableQuote.QuoteSummaryList.discountPercentage",editQuote:"NegotiableQuote.QuoteSummaryList.editQuote",file:"NegotiableQuote.QuoteSummaryList.file",files:"NegotiableQuote.QuoteSummaryList.files",heading:"NegotiableQuote.QuoteSummaryList.heading",regularPrice:"NegotiableQuote.QuoteSummaryList.regularPrice",savingsAmount:"NegotiableQuote.QuoteSummaryList.savingsAmount",viewMore:"NegotiableQuote.QuoteSummaryList.viewMore"});ve(()=>{const e=we.on("quote-management/quote-data",t=>{const{quote:a}=t;a&&(ce(a),ue(!1))},{eager:!0});return()=>e==null?void 0:e.off()},[]);const se=fe(()=>{le(e=>!e)},[]),U=(e,t)=>{if(u.includes("image"))return;const a={loading:t<4?"eager":"lazy",src:e.image.src,alt:e.image.alt,width:"300",height:"300",params:{width:300}},i=n(Ce,{"data-testid":"quote-summary-list-item-image",...a});return n(d,{name:"Thumbnail",slot:r==null?void 0:r.Thumbnail,context:{item:e,defaultImageProps:a},children:g?n("a",{href:g(e),children:i}):i})},X=e=>{if(!u.includes("name"))return n("span",{"data-testid":"quote-summary-list-item-title",children:g?n("a",{href:g(e),children:e.product.name}):e.product.name})},de=e=>{const t=e==null?void 0:e.map(i=>({label:i.label,value:i.values.map(l=>l.label).join(", ")})),a={};return t==null||t.forEach(i=>{a[i.label]=i.value}),Object.keys(a).length>0?a:null},me=e=>{const t=e==null?void 0:e.map(i=>({label:i.optionLabel,value:i.valueLabel})),a={};return t==null||t.forEach(i=>{a[i.label]=i.value}),Object.keys(a).length>0?a:null},ge=e=>{const t=e==null?void 0:e.map(i=>({label:i.label,type:i.type,values:i.values.map(l=>({label:l.label,value:l.value}))})),a={};return t==null||t.forEach(i=>{var l;switch(i.type){case"field":case"area":case"date_time":a[i.label]=i.values[0].value;break;case"radio":case"drop_down":a[i.label]=i.values[0].label;break;case"multiple":case"checkbox":a[i.label]=i.values.reduce((m,h)=>m?`${m}, ${h.label}`:h.label,"");break;case"file":{const m=new DOMParser,h=i.values[0].value,w=((l=m.parseFromString(h,"text/html").querySelector("a"))==null?void 0:l.textContent)||"";a[i.label]=w;break}}}),a},$=e=>{if(u.includes("configurations"))return;const t={...de(e.bundleOptions),...me(e.configurableOptions),...ge(e.customizableOptions),...e.links&&e.links.count?e.links.count>1?{[s.files.replace("{count}",e.links.count.toString())]:e.links.result}:{[s.file.replace("{count}",e.links.count.toString())]:e.links.result}:null};if(Object.keys(t).length!==0)return t},j=e=>(c==null?void 0:c.price)===p.TAX_INCLUDED?e.discounted?{amount:e.prices.regularPrice.value,currency:e.prices.regularPrice.currency,style:{font:"inherit"},"data-testid":"including-tax-item-price"}:{amount:e.prices.priceIncludingTax.value,currency:e.prices.priceIncludingTax.currency,style:{font:"inherit"},"data-testid":"including-tax-item-price"}:{amount:e.prices.regularPrice.value,currency:e.prices.regularPrice.currency,style:{font:"inherit"},"data-testid":"regular-item-price"},F=e=>{var t,a;return{amount:(t=e.savingsAmount)==null?void 0:t.value,currency:(a=e.savingsAmount)==null?void 0:a.currency,style:{font:"inherit"},"data-testid":"item-savings-amount"}},B=e=>(c==null?void 0:c.price)===p.TAX_INCLUDED_AND_EXCLUDED?n(I,{amount:e.prices.rowTotal.value,currency:e.prices.rowTotal.currency,"data-testid":"excluding-tax-total","aria-label":s.regularPrice}):void 0,z=e=>{var i,l,m,h,S,w,ee,te,ne,ae;const t={"aria-label":s.regularPrice},a=e.discounted?{}:null;return(c==null?void 0:c.price)===p.TAX_INCLUDED||(c==null?void 0:c.price)===p.TAX_INCLUDED_AND_EXCLUDED?(t.amount=(i=e.prices.rowTotalIncludingTax)==null?void 0:i.value,t.currency=(l=e.prices.rowTotalIncludingTax)==null?void 0:l.currency,t.variant=e.discounted?"strikethrough":"default",t["data-testid"]="including-tax-item-total",a&&(t.amount=(m=e.prices.originalRowTotal)==null?void 0:m.value,t.currency=(h=e.prices.originalRowTotal)==null?void 0:h.currency,a.amount=(S=e.prices.rowTotalIncludingTax)==null?void 0:S.value,a.currency=(w=e.prices.rowTotalIncludingTax)==null?void 0:w.currency,a.sale=!0,a["aria-label"]=s.discountedPrice,a["data-testid"]="discount-total")):(t.amount=(ee=e.prices.originalRowTotal)==null?void 0:ee.value,t.currency=(te=e.prices.originalRowTotal)==null?void 0:te.currency,t.variant=e.discounted?"strikethrough":"default",t["data-testid"]="regular-item-total",a&&(a.amount=(ne=e.discountedTotal)==null?void 0:ne.value,a.currency=(ae=e.discountedTotal)==null?void 0:ae.currency,a.sale=!0,a["aria-label"]=s.regularPrice,a["data-testid"]="discount-total")),{totalProps:t,discountProps:a}},V=e=>n(d,{name:"ProductAttributes",slot:r==null?void 0:r.ProductAttributes,context:{item:e}}),G=e=>n("span",{"data-testid":"quote-summary-list-item-sku",children:e.product.sku}),W=e=>n(d,{name:"Footer",slot:r==null?void 0:r.Footer,context:{item:e}}),he=e=>o!=null&&o.totalQuantity?o.items.filter(e).map((t,a)=>{const{totalProps:i,discountProps:l}=z(t),m=n(Qe,{loading:Q,"data-testid":`quote-summary-list-item-entry-${t.uid}`,image:U(t,a),title:n(d,{name:"ItemTitle",slot:r==null?void 0:r.ItemTitle,context:{item:t},children:X(t)}),sku:u.includes("sku")?void 0:n(d,{name:"ItemSku",slot:r==null?void 0:r.ItemSku,context:{item:t},children:G(t)}),price:u.includes("price")?void 0:n(d,{name:"ItemPrice",slot:r==null?void 0:r.ItemPrice,context:{item:t},slotTag:"span",children:n(I,{...j(t)})}),quantity:u.includes("quantity")?void 0:t.quantity,total:v(E,{children:[u.includes("total")?void 0:n(d,{name:"ItemTotal",slot:r==null?void 0:r.ItemTotal,context:{item:t},children:n(I,{...i})}),u.includes("totalDiscount")?void 0:l&&n(d,{name:"ItemTotal",slot:r==null?void 0:r.ItemTotal,context:{item:t},children:n(I,{...l})})]}),attributes:V(t),configurations:$(t),totalExcludingTax:u.includes("totalExcludingTax")?void 0:B(t),taxIncluded:(c==null?void 0:c.price)===p.TAX_INCLUDED,taxExcluded:!u.includes("totalExcludingTax")&&(c==null?void 0:c.price)===p.TAX_INCLUDED_AND_EXCLUDED,discount:k&&t.discounted&&t.discountPercentage!==void 0?n("div",{"data-testid":"item-discount-percentage",children:s.discountPercentage.replace("{discount}",t.discountPercentage.toString())}):void 0,savings:M&&t.discounted&&t.savingsAmount!==void 0?v("div",{children:[n("span",{children:n(I,{...F(t)})}),"Â ",s.savingsAmount]}):void 0,footer:W(t)},t.uid);return n(d,{name:"CartItem",slot:r==null?void 0:r.QuoteItem,context:{item:t,index:a,loading:Q,attributesToHide:u,quoteDisplaySettings:c,showDiscount:k,showSavings:M,dictionary:s,getImage:U,getTitle:X,getSku:G,getPriceProps:j,getTotalPriceProps:z,getProductAttributes:V,getConfigurations:$,getTotalExcludingTax:B,getFooter:W,getSavingsAmount:F},children:m},t.uid)}):null,Y=n(d,{name:"Heading",slot:r==null?void 0:r.Heading,context:{count:(o==null?void 0:o.totalQuantity)??0,quoteId:o==null?void 0:o.uid},children:n("div",{"data-testid":"default-quote-summary-list-heading",children:s.heading.replace("({count})",o!=null&&o.totalQuantity?`(${o==null?void 0:o.totalQuantity.toString()})`:"")})}),D=Y.props.children.props.children,C=he(e=>!e.outOfStock&&!e.insufficientQuantity),x=(o==null?void 0:o.items.length)||0,pe=A?Math.min(x,R):x,ye=x>pe,J=o!=null&&o.totalQuantity&&C?n(d,{name:"Footer",slot:r==null?void 0:r.QuoteSummaryFooter,context:{displayMaxItems:A},"data-testid":"quote-summary-list-footer-slot",className:"quote-management-quote-summary-list-footer",children:ye?n(be,{className:"quote-management-quote-summary-list-footer__action",onClick:se,"data-testid":"view-more-items-button",variant:"tertiary",children:s.viewMore}):null}):null,K=o!=null&&o.totalQuantity?n(Ie,{"data-testid":"quote-summary-list",children:C==null?void 0:C.slice(0,A?Math.min(x,R):x)}):null;return P?n(Te,{"data-testid":"quote-summary-list-accordion",className:y(["quote-management-quote-summary-list-accordion",`quote-management-quote-summary-list__background--${_}`]),iconOpen:Pe,iconClose:Ee,children:n(ke,{title:D,ariaLabelTitle:D,"data-testid":"quote-summary-list-accordion__section",open:!0,renderContentWhenClosed:!0,children:n(oe,{...O,"aria-expanded":!0,"aria-label":"TEST",className:"quote-management-quote-summary-list-accordion__list",footer:N?void 0:J,products:K,outOfStockMessage:void 0,loading:Q,variant:_})})}):n(oe,{...O,heading:f?void 0:Y,footer:N?void 0:J,products:K,outOfStockMessage:void 0,loading:Q,variant:_})};export{We as QuoteSummaryList,We as default};
//# sourceMappingURL=QuoteSummaryList.js.map
